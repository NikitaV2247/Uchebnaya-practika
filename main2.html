<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TransportCo - Транспортная компания</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <style>
        /* Общие стили */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html, body {
            height: 100%;
            font-family: 'Open Sans', sans-serif;
            color: #333;
        }
        
        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        
        /* Система уведомлений */
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-width: 400px;
        }
        
        .notification {
            padding: 16px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            display: flex;
            align-items: center;
            justify-content: space-between;
            animation: slideIn 0.3s ease-out;
            transform: translateX(0);
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
        }
        
        .notification.hiding {
            transform: translateX(100%);
            opacity: 0;
        }
        
        .notification-success {
            background-color: #d4edda;
            border-left: 4px solid #28a745;
            color: #155724;
        }
        
        .notification-error {
            background-color: #f8d7da;
            border-left: 4px solid #dc3545;
            color: #721c24;
        }
        
        .notification-warning {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            color: #856404;
        }
        
        .notification-info {
            background-color: #d1ecf1;
            border-left: 4px solid #17a2b8;
            color: #0c5460;
        }
        
        .notification-content {
            flex: 1;
            margin-right: 15px;
            font-size: 14px;
            line-height: 1.4;
        }
        
        .notification-close {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: inherit;
            opacity: 0.7;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: opacity 0.2s;
        }
        
        .notification-close:hover {
            opacity: 1;
            background-color: rgba(0, 0, 0, 0.1);
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        /* Шапка сайта */
        header {
            background: white;
            border-bottom: 1px solid #e0e0e0;
            padding: 15px 40px;
            position: sticky;
            top: 0;
            z-index: 100;
            flex-shrink: 0;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .logo {
            font-family: 'Montserrat', sans-serif;
            font-size: 24px;
            font-weight: bold;
            color: #0047AB;
            text-decoration: none;
            cursor: pointer;
        }
        
        nav {
            display: flex;
            gap: 30px;
            align-items: center;
        }
        
        nav a {
            color: #333;
            text-decoration: none;
            font-size: 14px;
            transition: color 0.3s;
            cursor: pointer;
        }
        
        nav a:hover {
            color: #0047AB;
        }
        
        nav a.active {
            color: #0047AB;
            font-weight: 600;
        }
        
        .auth-buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .btn-login, .btn-register, .btn-order {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            font-family: 'Montserrat', sans-serif;
        }
        
        .btn-login {
            border: 2px solid #0047AB;
            color: #0047AB;
            background: white;
        }
        
        .btn-login:hover {
            background: #0047AB;
            color: white;
        }
        
        .btn-register {
            border: 2px solid #0047AB;
            background: #0047AB;
            color: white;
        }
        
        .btn-register:hover {
            background: #003580;
        }
        
        .btn-order {
            border: 2px solid #F49B00;
            background: #F49B00;
            color: white;
        }
        
        .btn-order:hover {
            background: #d88800;
        }
        
        /* Основной контент */
        #content {
            flex: 1;
            transition: opacity 0.3s;
            display: flex;
            flex-direction: column;
        }
        
        .page-content {
            display: none;
            flex: 1;
        }
        
        .page-content.active {
            display: flex;
            flex-direction: column;
        }
        
        /* Подвал */
        footer {
            background: #0047AB;
            color: white;
            text-align: center;
            padding: 30px 40px;
            flex-shrink: 0;
            margin-top: auto;
        }
        
        footer p {
            font-size: 14px;
        }
        
        /* Стили главной страницы */
        .call {
            background: linear-gradient(135deg, #0047AB 0%, #003580 100%);
            color: white;
            padding: 80px 40px;
            text-align: left;
        }
        
        .call-content {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .call h1 {
            font-family: 'Montserrat', sans-serif;
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 20px;
            line-height: 1.2;
        }
        
        .call p {
            font-size: 16px;
            margin-bottom: 30px;
            max-width: 600px;
            line-height: 1.6;
        }
        
        .features {
            padding: 60px 40px;
        }
        
        .features-content {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .features h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 36px;
            text-align: center;
            margin-bottom: 50px;
            color: #333;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }
        
        .feature-card {
            background: #f9f9f9;
            padding: 30px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            text-align: center;
            transition: box-shadow 0.3s;
        }
        
        .feature-card:hover {
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .feature-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }
        
        .feature-card h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 18px;
            margin-bottom: 10px;
            color: #333;
        }
        
        .feature-card p {
            font-size: 14px;
            color: #666;
            line-height: 1.6;
        }
        
        .stats {
            background: linear-gradient(135deg, #0047AB 0%, #003580 100%);
            color: white;
            padding: 60px 40px;
            flex-shrink: 0;
            margin-top: auto;
        }
        
        .stats-content {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 40px;
            text-align: center;
        }
        
        .stat-item h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 42px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .stat-item p {
            font-size: 14px;
            opacity: 0.9;
        }
        
        /* Стили для заголовков страниц */
        .page-header {
            background: linear-gradient(135deg, #0047AB 0%, #003580 100%);
            color: white;
            padding: 60px 40px;
        }
        
        .page-header-content {
            max-width: 1400px;
            margin: 0 auto;
            text-align: center;
        }
        
        .page-header h1 {
            font-family: 'Montserrat', sans-serif;
            font-size: 42px;
            margin-bottom: 10px;
        }
        
        .page-header p {
            font-size: 16px;
        }
        
        /* Контейнер контента */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 60px 40px;
            flex: 1 0 auto;
        }
        
        /* Стили "О компании" */
        .about-section {
            margin-bottom: 50px;
        }
        
        .about-section h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 32px;
            color: #0047AB;
            margin-bottom: 20px;
        }
        
        .about-section p {
            font-size: 16px;
            line-height: 1.8;
            color: #666;
            margin-bottom: 15px;
        }
        
        .timeline {
            margin-top: 30px;
        }
        
        .timeline-item {
            background: #f9f9f9;
            padding: 25px;
            border-radius: 8px;
            border-left: 4px solid #F49B00;
            margin-bottom: 20px;
            display: flex;
            align-items: flex-start;
            gap: 20px;
        }
        
        .timeline-year {
            font-family: 'Montserrat', sans-serif;
            font-size: 20px;
            font-weight: bold;
            color: #0047AB;
            min-width: 80px;
            padding: 8px 12px;
            border-radius: 4px;
            text-align: center;
        }
        
        .timeline-content {
            flex: 1;
        }
        
        .timeline-content h4 {
            font-family: 'Montserrat', sans-serif;
            font-size: 18px;
            color: #0047AB;
            margin-bottom: 10px;
        }
        
        .timeline-content p {
            font-size: 14px;
            color: #666;
        }

        .values-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(275px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .value-card {
            background: #f9f9f9;
            padding: 25px;
            border-radius: 8px;
            border-left: 4px solid #F49B00;
        }

        .value-card h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 18px;
            color: #0047AB;
            margin-bottom: 10px;
        }

        .value-card p {
            font-size: 14px;
            color: #666;
        }
        
        /* Стили "Контакты" */
        .upper-section {
            display: grid;
            grid-template-columns: 1fr 1.5fr;
            gap: 60px;
            margin-bottom: 60px;
        }
        
        .contact-section, .map-container {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 8px;
            height: fit-content;
        }
        
        .contact-section h2, .map-container h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 28px;
            margin-bottom: 25px;
            color: #0047AB;
        }
        
        .contact-item {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .contact-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .contact-item h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 16px;
            color: #F49B00;
            margin-bottom: 8px;
        }
        
        .contact-item p {
            color: #666;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .map-placeholder {
            height: 500px;
            width: 100%;
            background: #e9ecef;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 18px;
        }
        
        .lower-section {
            margin: 0 -20px;
            padding: 40px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .contact-form h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 28px;
            margin-bottom: 25px;
            color: #0047AB;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }
        
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            font-family: 'Open Sans', sans-serif;
        }
        
        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #0047AB;
            box-shadow: 0 0 0 3px rgba(0, 71, 171, 0.1);
        }
        
        .contact-submit-btn {
            width: 100%;
            padding: 12px;
            background-color: #F49B00;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
            transition: background-color 0.3s;
        }
        
        .contact-submit-btn:hover {
            background-color: #003580;
        }
        
        /* Стили формы заказа */
        .order-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 60px 40px;
            flex: 1 0 auto;
        }
        
        .important-notice {
            background: #FFF9F0;
            border: 1px solid #F49B00;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 40px;
        }
        
        .important-notice p {
            font-size: 14px;
            color: #666;
            line-height: 1.6;
        }
        
        .form-section {
            margin-bottom: 40px;
        }
        
        .form-section h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 24px;
            color: #0047AB;
            margin-bottom: 20px;
        }
        
        .order-form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .order-form-group {
            margin-bottom: 20px;
        }
        
        .order-form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }
        
        .required:after {
            content: " *";
            color: #e74c3c;
        }
        
        .order-form-group input,
        .order-form-group textarea,
        .order-form-group select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            font-family: 'Open Sans', sans-serif;
        }
        
        .order-form-group input:focus,
        .order-form-group textarea:focus,
        .order-form-group select:focus {
            outline: none;
            border-color: #0047AB;
            box-shadow: 0 0 0 3px rgba(0, 71, 171, 0.1);
        }
        
        /* Стили для ошибок в форме заказа */
        .order-error-message {
            color: #e74c3c;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }
        
        .order-error-message.show {
            display: block;
        }
        
        .order-form-group input.error,
        .order-form-group textarea.error,
        .order-form-group select.error {
            border-color: #e74c3c;
            background-color: #fff9f9;
        }
        
        .order-divider {
            height: 1px;
            background: #e0e0e0;
            margin: 30px 0;
        }
        
        .weight-input {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .weight-input input {
            flex: 1;
        }
        
        .weight-input span {
            font-size: 14px;
            color: #666;
        }
        
        .volume-input {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .volume-input input {
            flex: 1;
        }
        
        .volume-input span {
            font-size: 14px;
            color: #666;
        }
        
        .weight-volume-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .checkbox-group {
            margin-bottom: 15px;
        }
        
        .checkbox-group label {
            display: flex;
            align-items: center;
            font-weight: normal;
            cursor: pointer;
        }
        
        .checkbox-group input {
            width: auto;
            margin-right: 10px;
        }
        
        .order-submit-btn {
            width: 100%;
            padding: 15px;
            background-color: #F49B00;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
            transition: background-color 0.3s;
        }
        
        .order-submit-btn:hover {
            background-color: #d88800;
        }
        
        /* Стили для модальных окон */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .modal.active {
            display: flex;
        }
        
        .auth-container {
            width: 100%;
            max-width: 450px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            position: relative;
        }
        
        .auth-header {
            color: rgb(0, 0, 0);
            padding: 25px 20px 15px;
            text-align: center;
            position: relative;
        }
        
        .close-auth-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 24px;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50%;
            transition: background-color 0.3s;
            color: #000;
            background: none;
            border: none;
        }
        
        .close-auth-btn:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }
        
        .auth-logo {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
            color: #0047AB;
        }
        
        .auth-subtitle {
            font-size: 16px;
            opacity: 0.8;
        }
        
        .auth-form-container {
            padding: 25px 30px;
        }
        
        .auth-input-group {
            margin-bottom: 20px;
        }
        
        .auth-input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }
        
        .auth-input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .auth-input::placeholder {
            color: #999;
            font-size: 14px;
        }
        
        .auth-input:focus {
            border-color: #0047AB;
            outline: none;
        }
        
        /* Стили для ошибок */
        .auth-input.error {
            border-color: #e74c3c;
            background-color: #fff9f9;
        }
        
        .error-message {
            color: #e74c3c;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }
        
        .error-message.show {
            display: block;
        }
        
        /* ОБЩИЙ отступ для строки с чекбоксом и ссылкой - УМЕНЬШЕН для авторизации */
        .auth-options-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        /* Увеличиваем отступ для формы регистрации */
        #registerModal .auth-options-row {
            margin: 25px 0;
        }
        
        .auth-checkbox-container {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 5px 0;
            margin-bottom: 30px;
        }
        
        .auth-custom-checkbox {
            position: relative;
            width: 20px;
            height: 20px;
            border: 2px solid #0047AB;
            border-radius: 4px;
            margin-right: 8px;
            flex-shrink: 0;
            transition: background-color 0.3s;
        }
        
        .auth-checkbox-container input {
            display: none;
        }
        
        .auth-checkmark {
            position: absolute;
            top: 1px;
            left: 5px;
            width: 6px;
            height: 12px;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .auth-checkbox-container input:checked + .auth-custom-checkbox {
            background-color: #0047AB;
        }
        
        .auth-checkbox-container input:checked + .auth-custom-checkbox .auth-checkmark {
            opacity: 1;
        }
        
        .auth-checkbox-text {
            font-size: 14px;
            color: #555;
        }
        
        /* Ссылка "Забыли пароль" в авторизации */
        .auth-forgot-password {
            font-size: 14px;
            color: #0047AB;
            text-decoration: none;
            cursor: pointer;
            padding: 5px 0;
            transition: color 0.3s;
            text-align: right;
        }
        
        .auth-forgot-password:hover {
            text-decoration: underline;
        }
        
        /* Убираем большой отступ снизу у чекбокса в авторизации */
        #loginModal .auth-checkbox-container {
            margin-bottom: 10px;
        }
        
        .auth-btn {
            width: 100%;
            padding: 14px;
            background: #0047AB;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 10px;
        }
        
        /* Кнопка входа с меньшим отступом сверху */
        #loginModal .auth-btn {
            margin-top: 5px;
        }
        
        .auth-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .register-btn {
            background: #F49B00;
        }
        
        .auth-link {
            text-align: center;
            font-size: 15px;
            color: #555;
            margin-top: 15px;
        }
        
        .auth-link a {
            color: #0047AB;
            text-decoration: none;
            font-weight: 600;
            cursor: pointer;
        }
        
        .auth-link a:hover {
            text-decoration: underline;
        }
        
        .auth-row {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .auth-row .auth-input-group {
            flex: 1;
        }
        
        /* Стили для модальных окон восстановления пароля */
        .forgot-password-info {
            text-align: center;
            margin: 15px 0 25px;
            color: #666;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .sms-code-info {
            text-align: center;
            margin: 10px 0 25px;
            color: #666;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .sms-code-input {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }
        
        .sms-code-input input {
            width: 50px;
            height: 60px;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            border: 2px solid #ddd;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .sms-code-input input:focus {
            border-color: #0047AB;
            outline: none;
            box-shadow: 0 0 0 3px rgba(0, 71, 171, 0.1);
        }
        
        .sms-timer {
            text-align: center;
            margin: 15px 0;
            color: #F49B00;
            font-size: 14px;
            font-weight: 600;
        }
        
        .resend-code {
            text-align: center;
            margin-top: 15px;
        }
        
        .resend-code a {
            color: #0047AB;
            text-decoration: none;
            font-size: 14px;
            cursor: pointer;
        }
        
        .resend-code a:hover {
            text-decoration: underline;
        }
        
        .resend-code.disabled a {
            color: #999;
            cursor: not-allowed;
        }
        
        .resend-code.disabled a:hover {
            text-decoration: none;
        }
        
        .divider {
            height: 1px;
            background: #e0e0e0;
            margin: 25px 0;
        }
        
        /* Стили для кнопок в модальных окнах восстановления */
        .forgot-password-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }
        
        .back-btn {
            flex: 1;
            padding: 14px;
            border: 2px solid #ddd;
            background: white;
            color: #333;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Montserrat', sans-serif;
        }
        
        .back-btn:hover {
            background: #f5f5f5;
            border-color: #bbb;
        }
        
        .recovery-btn {
            flex: 1;
            padding: 14px;
            background: #0047AB;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Montserrat', sans-serif;
        }
        
        .recovery-btn:hover {
            background: #003580;
        }
        
        /* Стили для кнопок в окне подтверждения кода */
        .confirm-code-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 25px;
        }
        
        /* Растягиваем обе кнопки на всю ширину */
        .confirm-code-buttons .back-btn,
        .confirm-code-buttons .continue-btn {
            width: 100%;
            text-align: center;
        }
        
        .continue-btn {
            padding: 14px;
            background: #0047AB;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Montserrat', sans-serif;
        }
        
        .continue-btn:hover {
            background: #003580;
        }
        
        /* Стили для страницы "Профиль" */
        .profile-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
        }

        .profile-nav-btn {
            padding: 12px 24px;
            background: none;
            border: none;
            font-size: 16px;
            font-weight: 600;
            color: #666;
            cursor: pointer;
            position: relative;
            font-family: 'Montserrat', sans-serif;
            transition: color 0.3s;
        }

        .profile-nav-btn:hover {
            color: #0047AB;
        }

        .profile-nav-btn.active {
            color: #0047AB;
        }

        .profile-nav-btn.active:after {
            content: '';
            position: absolute;
            bottom: -12px;
            left: 0;
            right: 0;
            height: 2px;
            background: #0047AB;
        }

        .profile-section {
            background: white;
            padding: 30px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            margin-bottom: 30px;
        }

        .profile-section h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 24px;
            color: #0047AB;
            margin-bottom: 20px;
        }

        .profile-section h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 18px;
            color: #333;
            margin: 25px 0 15px;
        }

        .profile-tab {
            display: block;
        }

        .profile-tab-content {
            width: 100%;
        }
        
        /* Стили для полей профиля только для чтения */
        .profile-field-readonly {
            border: none;
            background: transparent;
            box-shadow: none;
            pointer-events: none;
            color: #333;
            padding-left: 0;
            font-size: 16px;
            font-weight: 600;
            font-family: 'Open Sans', sans-serif;
        }
        
        .profile-field-readonly::placeholder {
            color: #333;
        }

        /* Стили для страницы "Мои заказы" в профиле */
        .filters-section {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border: 1px solid #e0e0e0;
        }

        .filter-row {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            align-items: end;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
            font-size: 14px;
        }

        .filter-group select,
        .filter-group input {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            font-family: 'Open Sans', sans-serif;
            height: 40px;
        }

        .filter-group select:focus,
        .filter-group input:focus {
            outline: none;
            border-color: #0047AB;
            box-shadow: 0 0 0 3px rgba(0, 71, 171, 0.1);
        }

        .reset-group {
            display: flex;
            justify-content: flex-end;
        }

        .reset-btn {
            padding: 10px 20px;
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 6px;
            color: #333;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            height: 40px;
        }

        .reset-btn:hover {
            background: #e9ecef;
            border-color: #bbb;
        }

        /* Статистика */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            text-align: center;
            border: 1px solid #e0e0e0;
        }

        .stat-number {
            font-size: 32px;
            font-weight: 700;
            color: #0047AB;
            margin-bottom: 5px;
            font-family: 'Montserrat', sans-serif;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
        }

        /* Таблица заказов */
        .orders-table-container {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #e0e0e0;
            margin-bottom: 40px;
            display: none;
            overflow-x: auto;
        }

        .table-header {
            display: grid;
            grid-template-columns: 100px 120px 170px 170px 170px 170px 200px 170px 170px 170px 220px;
            background: #f8f9fa;
            padding: 15px 20px;
            border-bottom: 1px solid #e0e0e0;
            font-weight: 600;
            color: #333;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            width: max-content;
        }

        .table-header-item {
            padding: 0 10px;
            text-align: left;
            white-space: nowrap;
        }

        .order-row {
            display: grid;
            grid-template-columns: 100px 120px 170px 170px 170px 170px 200px 170px 170px 170px 220px;
            padding: 20px 20px;
            border-bottom: 1px solid #f0f0f0;
            align-items: center;
            min-height: 80px;
        }

        .order-row:last-child {
            border-bottom: none;
        }

        .order-cell {
            padding: 0 10px;
            text-align: left;
        }

        .order-id {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .order-id-text {
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }

        /* Стили для правильного переноса слов в таблице */
        .date-container {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .date-day {
            font-size: 14px;
            color: #333;
            line-height: 1.2;
        }

        .date-year {
            font-size: 12px;
            color: #666;
            line-height: 1.2;
        }

        .address-container {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .address-line {
            font-size: 14px;
            color: #333;
            line-height: 1.2;
        }

        .cargo-text {
            font-size: 14px;
            color: #333;
            line-height: 1.4;
        }

        .order-status-cell {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .order-status {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            width: fit-content;
        }

        .order-status.delivered {
            background: #d4edda;
            color: #155724;
        }

        .order-status.delivered .status-icon {
            color: #28a745;
            font-size: 10px;
        }

        .order-status.in-transit {
            background: #fff3cd;
            color: #856404;
        }

        .order-status.in-transit .status-icon {
            color: #ffc107;
            font-size: 10px;
        }

        .order-status.processing {
            background: #cce5ff;
            color: #004085;
        }

        .order-status.processing .status-icon {
            color: #007bff;
            font-size: 10px;
        }

        .order-status.new {
            background: #e2e3e5;
            color: #383d41;
        }

        .order-status.new .status-icon {
            color: #6c757d;
            font-size: 10px;
        }

        .order-status.confirmed {
            background: #d1ecf1;
            color: #0c5460;
        }

        .order-status.confirmed .status-icon {
            color: #17a2b8;
            font-size: 10px;
        }

        .order-status.cancelled {
            background: #f8d7da;
            color: #721c24;
        }

        .order-status.cancelled .status-icon {
            color: #dc3545;
            font-size: 10px;
        }

        .order-price-cell {
            display: flex;
            flex-direction: column;
        }

        .order-price {
            font-size: 16px;
            font-weight: 700;
            color: #0047AB;
            font-family: 'Montserrat', sans-serif;
        }

        .order-actions-cell {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 5px;
        }

        .actions-container {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 5px;
            width: 100%;
        }

        .order-buttons {
            display: flex;
            flex-direction: column;
            gap: 8px;
            width: 100%;
        }

        .view-btn, .track-btn {
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Montserrat', sans-serif;
            border: 1px solid;
            width: 100%;
            text-align: center;
        }

        .view-btn {
            background: white;
            border-color: #0047AB;
            color: #0047AB;
        }

        .view-btn:hover {
            background: #0047AB;
            color: white;
        }

        .track-btn {
            background: #0047AB;
            border-color: #0047AB;
            color: white;
        }

        .track-btn:hover {
            background: #003580;
            border-color: #003580;
        }

        /* Сообщение при отсутствии заказов */
        .no-orders-container {
            background: white;
            border-radius: 8px;
            padding: 60px 40px;
            text-align: center;
            border: 1px solid #e0e0e0;
            display: block;
        }

        .no-orders-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .no-orders-container h3 {
            font-size: 24px;
            color: #333;
            margin-bottom: 10px;
            font-family: 'Montserrat', sans-serif;
        }

        .no-orders-container p {
            color: #666;
            margin-bottom: 30px;
        }
        
        /* ========== НОВЫЕ СТИЛИ ДЛЯ ВОДИТЕЛЯ И АДМИНА ========== */
        
        /* Панель водителя */
        .driver-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .driver-stat-card {
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            border: 1px solid #e0e0e0;
            text-align: center;
        }
        
        .driver-stat-number {
            font-size: 42px;
            font-weight: 700;
            color: #0047AB;
            margin-bottom: 10px;
            font-family: 'Montserrat', sans-serif;
        }
        
        .driver-stat-label {
            color: #666;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .driver-actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .driver-btn {
            flex: 1;
            padding: 10px 15px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Montserrat', sans-serif;
        }
        
        .btn-accept {
            background: #28a745;
            color: white;
        }
        
        .btn-accept:hover {
            background: #218838;
        }
        
        .btn-picked {
            background: #17a2b8;
            color: white;
        }
        
        .btn-picked:hover {
            background: #138496;
        }
        
        .btn-delivered {
            background: #6f42c1;
            color: white;
        }
        
        .btn-delivered:hover {
            background: #5a379f;
        }
        
        /* Панель администратора */
        .admin-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .admin-card {
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            border: 1px solid #e0e0e0;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .admin-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .admin-card-icon {
            font-size: 48px;
            margin-bottom: 15px;
            color: #0047AB;
        }
        
        .admin-card h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 18px;
            color: #333;
            margin-bottom: 10px;
        }
        
        .admin-card p {
            color: #666;
            font-size: 14px;
            line-height: 1.5;
        }
        
        /* Таблицы для админа */
        .admin-table-container {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #e0e0e0;
            margin-bottom: 40px;
        }
        
        .admin-table-header {
            display: grid;
            background: #f8f9fa;
            padding: 15px 20px;
            border-bottom: 1px solid #e0e0e0;
            font-weight: 600;
            color: #333;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .admin-table-row {
            display: grid;
            padding: 20px;
            border-bottom: 1px solid #f0f0f0;
            align-items: center;
        }
        
        .admin-table-row:last-child {
            border-bottom: none;
        }
        
        .admin-table-cell {
            padding: 10px;
        }
        
        /* Форма "Стать водителем" */
        .become-driver-form {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 8px;
            margin-bottom: 30px;
            border: 2px solid #e0e0e0;
        }
        
        .become-driver-form h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 20px;
            color: #0047AB;
            margin-bottom: 20px;
        }
        
        .driver-license-input {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .driver-license-input input {
            flex: 1;
        }
        
        /* Модальные окна для админа */
        .admin-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .admin-modal.active {
            display: flex;
        }
        
        .admin-modal-content {
            width: 100%;
            max-width: 800px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            position: relative;
        }
        
        .admin-modal-header {
            background: #0047AB;
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }
        
        .close-admin-modal {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 24px;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50%;
            transition: background-color 0.3s;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
        }
        
        .close-admin-modal:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .admin-modal-body {
            padding: 30px;
            max-height: 70vh;
            overflow-y: auto;
        }
        
        /* Навигация по ролям */
        .role-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
        }
        
        .role-nav-btn {
            padding: 12px 24px;
            background: none;
            border: none;
            font-size: 16px;
            font-weight: 600;
            color: #666;
            cursor: pointer;
            position: relative;
            font-family: 'Montserrat', sans-serif;
            transition: color 0.3s;
        }
        
        .role-nav-btn:hover {
            color: #0047AB;
        }
        
        .role-nav-btn.active {
            color: #0047AB;
        }
        
        .role-nav-btn.active:after {
            content: '';
            position: absolute;
            bottom: -12px;
            left: 0;
            right: 0;
            height: 2px;
            background: #0047AB;
        }
        
        /* Рейтинг водителя */
        .rating-stars {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
        }
        
        .star {
            font-size: 24px;
            color: #ddd;
        }
        
        .star.filled {
            color: #FFC107;
        }
        
        /* Адаптивность для новых элементов */
        @media (max-width: 768px) {
            .driver-dashboard, .admin-dashboard {
                grid-template-columns: 1fr;
            }
            
            .driver-actions {
                flex-direction: column;
            }
            
            .admin-table-header, .admin-table-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .admin-table-cell:before {
                content: attr(data-label);
                font-weight: 600;
                color: #666;
                font-size: 12px;
                text-transform: uppercase;
                margin-right: 10px;
                text-align: left;
                flex: 0 0 100px;
            }
            
            .role-nav {
                flex-direction: column;
            }
            
            .role-nav-btn {
                text-align: left;
                padding: 10px;
            }
            
            .role-nav-btn.active:after {
                bottom: -5px;
            }
        }
        
        /* Адаптивность */
        @media (max-width: 1200px) {
            .table-header {
                grid-template-columns: 100px 120px 170px 170px 170px 170px 200px 170px 170px 220px;
            }
            
            .order-row {
                grid-template-columns: 100px 120px 170px 170px 170px 170px 200px 170px 170px 220px;
            }
        }
        
       @media (max-width: 1024px) {
            .filter-row {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .table-header {
                grid-template-columns: 1fr 1fr 1.2fr 1.2fr;
            }
            
            .order-row {
                grid-template-columns: 1fr 1fr 1.2fr 1.2fr;
            }
            
            /* Для планшетов делаем кнопки в строку */
            .order-buttons {
                flex-direction: row;
            }
                
            .view-btn, .track-btn {
                width: auto;
                min-width: 100px;
            }
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            nav {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .upper-section {
                grid-template-columns: 1fr;
                gap: 30px;
            }
            
            .order-form-row, .weight-volume-row {
                grid-template-columns: 1fr;
            }
            
            .auth-row {
                flex-direction: column;
                gap: 0;
            }
            
            .auth-options-row {
                flex-direction: row;
                align-items: center;
                justify-content: space-between;
                gap: 10px;
                flex-wrap: nowrap;
            }
            
            .auth-form-container {
                padding: 20px;
            }
            
            .forgot-password-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .sms-code-input {
                gap: 8px;
            }
            
            .sms-code-input input {
                width: 45px;
                height: 55px;
                font-size: 20px;
            }
            
            .filter-row {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .table-header {
                display: none;
            }
            
            .order-row {
                grid-template-columns: 1fr;
                gap: 15px;
                padding: 20px;
                border-bottom: 2px solid #f0f0f0;
                position: relative;
            }
            
            .order-cell {
                padding: 0;
                display: flex;
                justify-content: space-between;
                align-items: flex-start;
                text-align: right;
            }
            
            .order-cell:before {
                content: attr(data-label);
                font-weight: 600;
                color: #666;
                font-size: 12px;
                text-transform: uppercase;
                margin-right: 10px;
                text-align: left;
                flex: 0 0 100px;
            }
            
            .order-id-text {
                font-size: 16px;
            }
            
            .order-shiping-date, .order-cargo, .order-status-cell, .order-price-cell, .order-actions-cell {
                display: flex;
            }
            
            .date-container, .address-container {
                text-align: right;
                align-items: flex-end;
            }
            
            .date-day, .date-year, .address-line, .cargo-text {
                text-align: right;
            }
            
            .order-actions-cell {
                flex-direction: column;
                align-items: stretch;
                margin-top: 15px;
                padding-top: 15px;
                border-top: 1px dashed #e0e0e0;
            }
            
            .actions-container {
                width: 100%;
            }
            
            .order-buttons {
                flex-direction: column;
                width: 100%;
            }
            
            .view-btn, .track-btn {
                width: 100%;
                text-align: center;
                padding: 10px;
                font-size: 14px;
            }

            /* Показываем все ячейки для мобильной версии */
            .order-shipping-date-cell, .order-category-cell {
                display: flex;
            }
        }
        
        @media (max-width: 480px) {
            header, .call, .features, .stats, .page-header, .container, .order-container {
                padding-left: 20px;
                padding-right: 20px;
            }
            
            .call h1 {
                font-size: 36px;
            }
            
            .features h2, .section-title, .page-header h1 {
                font-size: 28px;
            }
            
            .auth-options-row {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
                gap: 5px;
            }
            
            .auth-checkbox-text {
                font-size: 12px;
                white-space: nowrap;
            }
            
            /* Исправления для placeholder в мобильной версии */
            .auth-input {
                font-size: 14px;
            }
            
            .auth-input::placeholder {
                font-size: 12px;
            }
            
            .sms-code-input input {
                width: 40px;
                height: 50px;
                font-size: 18px;
            }
            
            .order-cell:before {
                flex: 0 0 80px;
                font-size: 11px;
            }
            
            .profile-nav-btn {
                padding: 10px 15px;
                font-size: 14px;
            }
            
            /* Уведомления на мобильных */
            .notification-container {
                top: 10px;
                right: 10px;
                left: 10px;
                max-width: none;
            }
            
            .notification {
                padding: 12px 16px;
            }
        }
    </style>
</head>
<body>
    <!-- Контейнер для уведомлений -->
    <div class="notification-container" id="notificationContainer"></div>
    
    <!-- Шапка сайта -->
    <header>
        <div class="header-content">
            <div class="logo" onclick="showPage('main')">TransportCo</div>
            <nav>
                <a onclick="showPage('main')" class="active">Главная</a>
                <a onclick="showPage('about')">О компании</a>
                <a onclick="showPage('contacts')">Контакты</a>
                <!-- Скрытые ссылки для водителя и админа -->
                <a id="driver-link" onclick="showPage('driver')" style="display: none;">Водителю</a>
                <a id="admin-link" onclick="showPage('admin')" style="display: none;">Админ</a>
            </nav>
            <div class="auth-buttons">
                <div id="unauth-buttons" style="display: flex; gap: 10px;">
                    <button class="btn-login" onclick="openLoginModal()">Вход</button>
                    <button class="btn-register" onclick="openRegisterModal()">Регистрация</button>
                </div>
                <div id="auth-user-buttons" style="display: none; gap: 10px;">
                    <button class="btn-order" onclick="showPage('profile')">Профиль</button>
                    <button class="btn-login" onclick="logout()">Выйти</button>
                </div>
                <button class="btn-order" onclick="showPage('order')">Заказать перевозку</button>
            </div>
        </div>
    </header>

    <!-- Основной контент -->
    <div id="content">
        <!-- Главная страница -->
        <div id="main-page" class="page-content active">
            <section class="call">
                <div class="call-content">
                    <h1>Надежная доставка грузов</h1>
                    <p>Профессиональная транспортная компания с опытом более 10 лет. Быстрая и безопасная доставка по всему региону.</p>
                    <button class="btn-order" onclick="showPage('order')">Заказать перевозку</button>
                </div>
            </section>
            
            <section class="features">
                <div class="features-content">
                    <h2>Почему выбирают нас</h2>
                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-icon">🚚</div>
                            <h3>Современный парк</h3>
                            <p>Новые автомобили с GPS-отслеживанием и кондиционированием</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">⏱️</div>
                            <h3>Быстрая доставка</h3>
                            <p>Оптимальные маршруты и своевременное прибытие гарантированы</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">🔒</div>
                            <h3>Безопасность</h3>
                            <p>Страховка груза и профессиональные водители с лицензиями</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">📍</div>
                            <h3>Везде доступны</h3>
                            <p>Доставка в любую точку региона и соседние области</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <section class="stats">
                <div class="stats-content">
                    <div class="stat-item">
                        <h3>10+</h3>
                        <p>Лет опыта</p>
                    </div>
                    <div class="stat-item">
                        <h3>500+</h3>
                        <p>Автомобилей</p>
                    </div>
                    <div class="stat-item">
                        <h3>50K+</h3>
                        <p>Доставок</p>
                    </div>
                    <div class="stat-item">
                        <h3>99%</h3>
                        <p>Довольных клиентов</p>
                    </div>
                </div>
            </section>
        </div>

        <!-- Страница "О компании" -->
        <div id="about-page" class="page-content">
            <div class="page-header">
                <div class="page-header-content">
                    <h1>О компании TransportCo</h1>
                </div>
            </div>
            
            <div class="container">
                <div class="about-section">
                    <h2>Наша история</h2>
                    <p>TransportCo - это профессиональная транспортная компания с более чем 10-летним опытом работы на рынке логистики и грузоперевозок. Мы специализируемся на надежной и быстрой доставке грузов по всей стране.</p>
                    <p>Наша компания имеет собственный парк из более 500 автомобилей различных типов и грузоподъемности, что позволяет нам предложить решение для любых задач перевозки.</p>
                </div>
                
                <div class="about-section">
                    <h2>История развития</h2>
                    <div class="timeline">
                        <div class="timeline-item">
                            <div class="timeline-year">2015</div>
                            <div class="timeline-content">
                                <h4>Основание компании</h4>
                                <p>TransportCo была основана как небольшая семейная компания с 5 автомобилями</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-year">2017</div>
                            <div class="timeline-content">
                                <h4>Расширение парка</h4>
                                <p>Увеличение парка до 50 автомобилей и открытие филиалов в соседних городах</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-year">2019</div>
                            <div class="timeline-content">
                                <h4>Внедрение GPS-мониторинга</h4>
                                <p>Установка систем GPS-отслеживания на все автомобили для лучшего контроля</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-year">2021</div>
                            <div class="timeline-content">
                                <h4>Достижение 500 автомобилей</h4>
                                <p>Парк компании достигает 500 единиц техники, обслуживая более 50 000 доставок в год</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-year">2023</div>
                            <div class="timeline-content">
                                <h4>Запуск онлайн-платформы</h4>
                                <p>Открытие веб-сайта и мобильного приложения для удобного заказа услуг</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="about-section">
                    <h2>Наши ценности</h2>
                    <div class="values-grid">
                        <div class="value-card">
                            <h3>Надежность</h3>
                            <p>Мы гарантируем своевременную доставку и полную сохранность вашего груза</p>
                        </div>
                        <div class="value-card">
                            <h3>Профессионализм</h3>
                            <p>Наша команда состоит из опытных специалистов и водителей с лицензиями</p>
                        </div>
                        <div class="value-card">
                            <h3>Инновация</h3>
                            <p>Мы используем современные технологии для отслеживания и управления перевозками</p>
                        </div>
                        <div class="value-card">
                            <h3>Клиентоориентированность</h3>
                            <p>Ваши потребности - наш приоритет. Мы готовы найти решение для любой задачи</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Страница "Контакты" -->
        <div id="contacts-page" class="page-content">
            <div class="page-header">
                <div class="page-header-content">
                    <h1>Контакты</h1>
                </div>
            </div>
            
            <div class="container">
                <div class="upper-section">
                    <div class="contact-section">
                        <h2>Информация о компании</h2>
                        <div class="contact-item">
                            <h3>Адрес</h3>
                            <p>г. Кострома, ул. Титова, д.4</p>
                        </div>
                        <div class="contact-item">
                            <h3>Телефон</h3>
                            <p>+7 (812) 156-43-89</p>
                        </div>
                        <div class="contact-item">
                            <h3>Email</h3>
                            <p>info@transportco.ru</p>
                        </div>
                        <div class="contact-item">
                            <h3>Режим работы</h3>
                            <p>Пн-Пт: 5:00 - 20:00<br>Сб-Вс: Выходной</p>
                        </div>
                    </div>
                    
                    <div class="map-container">
                        <div class="map-placeholder">
                            Здесь будет карта
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Страница "Профиль" -->
        <div id="profile-page" class="page-content">
            <div class="page-header">
                <div class="page-header-content">
                    <h1>Профиль</h1>
                    <p>Управление вашими данными и заказами</p>
                </div>
            </div>
            
            <div class="container">
                <!-- Навигация профиля -->
                <div class="profile-nav">
                    <button class="profile-nav-btn active" onclick="showProfileTab('data')">Данные</button>
                    <button class="profile-nav-btn" onclick="showProfileTab('orders')">Мои заказы</button>
                    <button class="profile-nav-btn" onclick="showProfileTab('driver')" id="become-driver-tab">Стать водителем</button>
                </div>
                
                <!-- Содержимое вкладок -->
                <div id="profile-tab-content" class="profile-tab-content">
                    <!-- Вкладка Данные -->
                    <div id="profile-data" class="profile-tab active">
                        <div class="profile-section">
                            <h2>Личные данные</h2>
                            <form id="profile-form" onsubmit="handleProfileSubmit(event)">
                                <div class="order-form-row">
                                    <div class="order-form-group">
                                        <label for="profile-first-name">Имя</label>
                                        <input type="text" id="profile-first-name" class="profile-field-readonly" placeholder="Иван" value="Иван" readonly>
                                    </div>
                                    <div class="order-form-group">
                                        <label for="profile-last-name">Фамилия</label>
                                        <input type="text" id="profile-last-name" class="profile-field-readonly" placeholder="Иванов" value="Иванов" readonly>
                                    </div>
                                </div>
                                
                                <div class="order-form-row">
                                    <div class="order-form-group">
                                        <label for="profile-email">Email</label>
                                        <input type="email" id="profile-email" class="profile-field-readonly" placeholder="your@email.com" value="ivan@example.com" readonly>
                                    </div>
                                    <div class="order-form-group">
                                        <label for="profile-phone">Телефон</label>
                                        <input type="tel" id="profile-phone" class="profile-field-readonly" placeholder="+7 (912) 156-43-89" value="+7 (912) 156-43-89" readonly>
                                    </div>
                                </div>
                                
                                <h3>Смена пароля</h3>
                                <div class="order-divider"></div>
                                
                                <div class="order-form-group">
                                    <label for="profile-current-password">Текущий пароль</label>
                                    <input type="password" id="profile-current-password" placeholder="Текущий пароль">
                                </div>
                                
                                <div class="order-form-row">
                                    <div class="order-form-group">
                                        <label for="profile-new-password">Новый пароль</label>
                                        <input type="password" id="profile-new-password" placeholder="Новый пароль">
                                    </div>
                                    <div class="order-form-group">
                                        <label for="profile-confirm-password">Подтвердите пароль</label>
                                        <input type="password" id="profile-confirm-password" placeholder="Подтвердите пароль">
                                    </div>
                                </div>
                                
                                <button type="submit" class="order-submit-btn">Сохранить изменения</button>
                            </form>
                        </div>
                        
                        <div class="profile-section">
                            <h2>Настройки уведомлений</h2>
                            <div class="checkbox-group">
                                <label>
                                    <input type="checkbox" id="notify-email" checked>
                                    Уведомления по Email
                                </label>
                            </div>
                            <div class="checkbox-group">
                                <label>
                                    <input type="checkbox" id="notify-sms" checked>
                                    Уведомления по SMS
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Вкладка Мои заказы -->
                    <div id="profile-orders" class="profile-tab" style="display: none;">
                        <!-- Фильтры и поиск -->
                        <div class="filters-section">
                            <div class="filter-row">
                                <div class="filter-group">
                                    <label for="profile-status-filter">Статус:</label>
                                    <select id="profile-status-filter">
                                        <option>Все заказы</option>
                                        <option>В обработке</option>
                                        <option>В пути</option>
                                        <option>Доставлен</option>
                                        <option>Отменен</option>
                                    </select>
                                </div>
                                
                                <div class="filter-group">
                                    <label for="profile-period-filter">Период:</label>
                                    <select id="profile-period-filter">
                                        <option>Все время</option>
                                        <option>За неделю</option>
                                        <option>За месяц</option>
                                        <option>За 3 месяца</option>
                                        <option>За год</option>
                                    </select>
                                </div>
                                
                                <div class="filter-group">
                                    <label for="profile-search-input">Поиск:</label>
                                    <input type="text" id="profile-search-input" placeholder="Номер заказа или адрес...">
                                </div>
                                
                                <div class="filter-group reset-group">
                                    <button class="reset-btn" onclick="resetProfileFilters()">Сбросить</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Статистика -->
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-number" id="profile-total-orders-count">0</div>
                                <div class="stat-label">Всего заказов</div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-number" id="profile-processing-orders-count">0</div>
                                <div class="stat-label">В обработке</div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-number" id="profile-in-transit-orders-count">0</div>
                                <div class="stat-label">В пути</div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-number" id="profile-delivered-orders-count">0</div>
                                <div class="stat-label">Доставлено</div>
                            </div>
                        </div>
                        
                        <!-- Таблица заказов -->
                        <div id="profile-orders-table" class="orders-table-container" style="display: none;">
                            <div class="table-header">
                                <div class="table-header-item">№ ЗАКАЗА</div>
                                <div class="table-header-item">ДАТА ЗАЯВКИ</div>
                                <div class="table-header-item">ДАТА ОТПРАВЛЕНИЯ</div>
                                <div class="table-header-item">АДРЕС ОТПРАВЛЕНИЯ</div>
                                <div class="table-header-item">АДРЕС ДОСТАВКИ</div>
                                <div class="table-header-item">ГРУЗ</div>
                                <div class="table-header-item">КАТЕГОРИЯ</div>
                                <div class="table-header-item">СТАТУС</div>
                                <div class="table-header-item">РАССТОЯНИЕ</div>
                                <div class="table-header-item">ЦЕНА</div>
                                <div class="table-header-item">ДЕЙСТВИЯ</div>
                            </div>
                        </div>
                        
                        <!-- Сообщение при отсутствии заказов -->
                        <div id="profile-no-orders-message" class="no-orders-container" style="display: block;">
                            <div class="no-orders-icon">📦</div>
                            <h3>Заказов нет</h3>
                            <p>У вас пока нет оформленных заказов</p>
                            <button class="btn-order" onclick="showPage('order')">Сделать первый заказ</button>
                        </div>
                    </div>
                    
                    <!-- Вкладка "Стать водителем" -->
                    <div id="profile-driver" class="profile-tab" style="display: none;">
                        <div class="become-driver-form">
                            <h3>Подать заявку на работу водителем</h3>
                            <form id="driver-application-form" onsubmit="handleDriverApplication(event)">
                                <div class="order-form-row">
                                    <div class="order-form-group">
                                        <label for="driver-license">Водительское удостоверение</label>
                                        <div class="driver-license-input">
                                            <input type="text" id="driver-license" placeholder="Серия и номер" required>
                                        </div>
                                    </div>
                                    <div class="order-form-group">
                                        <label for="driver-experience">Опыт вождения (лет)</label>
                                        <input type="number" id="driver-experience" min="0" max="50" placeholder="3" required>
                                    </div>
                                </div>
                                
                                <div class="order-form-row">
                                    <div class="order-form-group">
                                        <label for="driver-vehicle-type">Тип транспорта</label>
                                        <select id="driver-vehicle-type" required>
                                            <option value="">Выберите тип</option>
                                            <option value="light">Легковой автомобиль</option>
                                            <option value="van">Микроавтобус</option>
                                            <option value="truck">Грузовой автомобиль</option>
                                            <option value="refrigerator">Рефрижератор</option>
                                        </select>
                                    </div>
                                    <div class="order-form-group">
                                        <label for="driver-phone">Контактный телефон</label>
                                        <input type="tel" id="driver-phone" placeholder="+7 (912) 345-67-89" required>
                                    </div>
                                </div>
                                
                                <div class="order-form-group">
                                    <label for="driver-comment">Дополнительная информация</label>
                                    <textarea id="driver-comment" rows="4" placeholder="Опыт работы, рекомендации и т.д."></textarea>
                                </div>
                                
                                <div class="checkbox-group">
                                    <label>
                                        <input type="checkbox" id="driver-agree" required>
                                        Согласен на обработку персональных данных
                                    </label>
                                </div>
                                
                                <button type="submit" class="order-submit-btn">Подать заявку</button>
                            </form>
                        </div>
                        
                        <div id="driver-application-status" style="display: none;">
                            <div class="profile-section">
                                <h2>Статус заявки</h2>
                                <div id="driver-status-content"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Страница "Заказ перевозки" -->
        <div id="order-page" class="page-content">
            <div class="page-header">
                <div class="page-header-content">
                    <h1>Заказать перевозку</h1>
                </div>
            </div>
            
            <div class="order-container">
                <div class="important-notice">
                    <p><strong>Важно:</strong> Заполните все поля формы для оформления заказа. Наш менеджер свяжется с вами в течение 30 минут для подтверждения деталей.</p>
                </div>
                
                <form id="orderForm" onsubmit="handleOrderSubmit(event)">
                    <!-- Информация об отправителе -->
                    <div class="form-section">
                        <h2>Информация об отправителе</h2>

                        <div class="order-divider"></div>
                        
                        <div class="order-form-row">
                            <div class="order-form-group">
                                <label for="sender-name" class="required">Ваше имя</label>
                                <input type="text" id="sender-name" placeholder="Иван Иванов" required>
                                <div class="order-error-message" id="sender-name-error"></div>
                            </div>
                            
                            <div class="order-form-group">
                                <label for="sender-phone" class="required">Телефон</label>
                                <input type="tel" id="sender-phone" placeholder="+7 (912) 156-43-89" required>
                                <div class="order-error-message" id="sender-phone-error"></div>
                            </div>
                        </div>
                        
                        <div class="order-form-group">
                            <label for="sender-email">Email</label>
                            <input type="email" id="sender-email" placeholder="your@email.com">
                            <div class="order-error-message" id="sender-email-error"></div>
                        </div>
                    </div>
                    
                    <!-- Информация о грузе -->
                    <div class="form-section">
                        <h2>Информация о грузе</h2>

                        <div class="order-divider"></div>
                        
                        <div class="order-form-group">
                            <label for="cargo-description" class="required">Описание груза</label>
                            <textarea id="cargo-description" placeholder="Опишите груз, его характеристики и особенности упаковки" rows="3" required></textarea>
                            <div class="order-error-message" id="cargo-description-error"></div>
                        </div>
                        
                        <!-- Добавлено поле для категории товаров -->
                        <div class="order-form-group">
                            <label for="product-category" class="required">Категория товара</label>
                            <select id="product-category" required>
                                <option value="">Выберите категорию</option>
                                <option value="electronics">Электроника</option>
                                <option value="clothing">Одежда и обувь</option>
                                <option value="furniture">Мебель</option>
                                <option value="food">Продукты питания</option>
                                <option value="building">Строительные материалы</option>
                                <option value="auto">Автозапчасти</option>
                                <option value="industrial">Промышленное оборудование</option>
                                <option value="chemicals">Химические вещества</option>
                                <option value="documents">Документы</option>
                                <option value="other">Другое</option>
                            </select>
                            <div class="order-error-message" id="product-category-error"></div>
                        </div>
                        
                        <div class="order-form-group">
                            <label for="cargo-weight" class="required">Вес груза</label>
                            <div class="weight-input">
                                <input type="number" id="cargo-weight" placeholder="1" required>
                                <span>кг</span>
                            </div>
                            <div class="order-error-message" id="cargo-weight-error"></div>
                        </div>
                        
                        <div class="order-form-group">
                            <label for="cargo-volume" class="required">Объем</label>
                            <div class="volume-input">
                                <input type="number" id="cargo-volume" placeholder="1" required>
                                <span>м³</span>
                            </div>
                            <div class="order-error-message" id="cargo-volume-error"></div>
                        </div>
                        
                        <div class="order-form-row">
                            <div class="order-form-group">
                                <label for="cargo-type" class="required">Тип груза</label>
                                <select id="cargo-type" required>
                                    <option value="">Выберите тип груза</option>
                                    <option value="general">Общий груз</option>
                                    <option value="fragile">Хрупкий груз</option>
                                    <option value="dangerous">Опасный груз</option>
                                    <option value="perishable">Скоропортящийся груз</option>
                                </select>
                                <div class="order-error-message" id="cargo-type-error"></div>
                            </div>
                            
                            <div class="order-form-group">
                                <label for="shipping-date" class="required">Дата отправки</label>
                                <input type="date" id="shipping-date" required>
                                <div class="order-error-message" id="shipping-date-error"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Адреса доставки -->
                    <div class="form-section">
                        <h2>Адреса доставки</h2>

                        <div class="order-divider"></div>
                        
                        <div class="order-form-group">
                            <label for="pickup-address" class="required">Адрес отправки</label>
                            <input type="text" id="pickup-address" placeholder="Кострома, ул. Ленина, д. 10" required>
                            <div class="order-error-message" id="pickup-address-error"></div>
                        </div>
                        
                        <div class="order-form-group">
                            <label for="delivery-address" class="required">Адрес доставки</label>
                            <input type="text" id="delivery-address" placeholder="Москва, ул. Арбат, д. 5" required>
                            <div class="order-error-message" id="delivery-address-error"></div>
                        </div>

                        <!-- Скрытое поле для расстояния -->
                        <div class="order-form-group" style="display: none;">
                            <input type="hidden" id="distance-km" value="0">
                        </div>
                    </div>
                    
                    <!-- Дополнительные услуги -->
                    <div class="form-section">
                        <h2>Дополнительные услуги</h2>

                        <div class="order-divider"></div>
                        
                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" id="insurance">
                                Страховка груза (1% от стоимости)
                            </label>
                        </div>
                        
                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" id="packaging">
                                Профессиональная упаковка (+2000 ₽)
                            </label>
                        </div>
                    </div>
                    
                    <!-- Комментарии -->
                    <div class="form-section">
                        <h2>Комментарии</h2>
                        
                        <div class="order-form-group">
                            <textarea id="comments" placeholder="Дополнительная информация для менеджера..." rows="4"></textarea>
                        </div>
                    </div>
                    
                    <button type="submit" class="order-submit-btn">Оформить заказ</button>
                </form>
            </div>
        </div>
        
        <!-- Страница "Водитель" -->
        <div id="driver-page" class="page-content">
            <div class="page-header">
                <div class="page-header-content">
                    <h1>Кабинет водителя</h1>
                    <p>Управление заказами и статистика</p>
                </div>
            </div>
            
            <div class="container">
                <!-- Навигация водителя -->
                <div class="role-nav">
                    <button class="role-nav-btn active" onclick="showDriverTab('available')">Доступные заказы</button>
                    <button class="role-nav-btn" onclick="showDriverTab('my-orders')">Мои заказы</button>
                    <button class="role-nav-btn" onclick="showDriverTab('history')">История доставок</button>
                    <button class="role-nav-btn" onclick="showDriverTab('profile')">Профиль</button>
                </div>
                
                <!-- Содержимое вкладок водителя -->
                <div id="driver-tab-content">
                    <!-- Вкладка "Доступные заказы" -->
                    <div id="driver-available" class="profile-tab active">
                        <div class="driver-dashboard">
                            <div class="driver-stat-card">
                                <div class="driver-stat-number" id="available-orders-count">0</div>
                                <div class="driver-stat-label">Доступных заказов</div>
                            </div>
                            <div class="driver-stat-card">
                                <div class="driver-stat-number" id="my-active-orders">0</div>
                                <div class="driver-stat-label">Активных заказов</div>
                            </div>
                            <div class="driver-stat-card">
                                <div class="driver-stat-number" id="driver-rating">4.8</div>
                                <div class="driver-stat-label">Рейтинг</div>
                            </div>
                        </div>
                        
                        <div id="available-orders-list" class="orders-table-container">
                            <!-- Список доступных заказов -->
                        </div>
                    </div>
                    
                    <!-- Вкладка "Мои заказы" -->
                    <div id="driver-my-orders" class="profile-tab" style="display: none;">
                        <div id="active-orders-list" class="orders-table-container">
                            <!-- Список активных заказов водителя -->
                        </div>
                    </div>
                    
                    <!-- Вкладка "История доставок" -->
                    <div id="driver-history" class="profile-tab" style="display: none;">
                        <div id="delivery-history" class="orders-table-container">
                            <!-- История завершенных заказов -->
                        </div>
                    </div>
                    
                    <!-- Вкладка "Профиль водителя" -->
                    <div id="driver-profile" class="profile-tab" style="display: none;">
                        <div class="profile-section">
                            <h2>Профиль водителя</h2>
                            <div class="order-form-row">
                                <div class="order-form-group">
                                    <label>Водительское удостоверение</label>
                                    <input type="text" class="profile-field-readonly" id="driver-profile-license" readonly>
                                </div>
                                <div class="order-form-group">
                                    <label>Опыт вождения</label>
                                    <input type="text" class="profile-field-readonly" id="driver-profile-experience" readonly>
                                </div>
                            </div>
                            <div class="order-form-row">
                                <div class="order-form-group">
                                    <label>Тип транспорта</label>
                                    <input type="text" class="profile-field-readonly" id="driver-profile-vehicle" readonly>
                                </div>
                                <div class="order-form-group">
                                    <label>Рейтинг</label>
                                    <div class="rating-stars" id="driver-rating-stars"></div>
                                </div>
                            </div>
                            <div class="order-form-row">
                                <div class="order-form-group">
                                    <label>Доставлено заказов</label>
                                    <input type="text" class="profile-field-readonly" id="driver-profile-delivered" readonly>
                                </div>
                                <div class="order-form-group">
                                    <label>Общий пробег</label>
                                    <input type="text" class="profile-field-readonly" id="driver-profile-mileage" readonly>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Страница "Администратор" -->
        <div id="admin-page" class="page-content">
            <div class="page-header">
                <div class="page-header-content">
                    <h1>Панель администратора</h1>
                    <p>Управление системой и пользователями</p>
                </div>
            </div>
            
            <div class="container">
                <!-- Навигация администратора -->
                <div class="role-nav">
                    <button class="role-nav-btn active" onclick="showAdminTab('dashboard')">Главная</button>
                    <button class="role-nav-btn" onclick="showAdminTab('driver-applications')">Заявки водителей</button>
                    <button class="role-nav-btn" onclick="showAdminTab('drivers')">Водители</button>
                    <button class="role-nav-btn" onclick="showAdminTab('orders')">Заказы</button>
                    <button class="role-nav-btn" onclick="showAdminTab('assign-driver')">Назначить водителя</button>
                </div>
                
                <!-- Содержимое вкладок администратора -->
                <div id="admin-tab-content">
                    <!-- Вкладка "Главная" -->
                    <div id="admin-dashboard" class="profile-tab active">
                        <div class="admin-dashboard">
                            <div class="admin-card" onclick="showAdminTab('driver-applications')">
                                <div class="admin-card-icon">📋</div>
                                <h3>Заявки водителей</h3>
                                <p id="pending-applications-count">0 ожидают рассмотрения</p>
                            </div>
                            <div class="admin-card" onclick="showAdminTab('drivers')">
                                <div class="admin-card-icon">👨‍✈️</div>
                                <h3>Водители</h3>
                                <p id="active-drivers-count">0 активных водителей</p>
                            </div>
                            <div class="admin-card" onclick="showAdminTab('orders')">
                                <div class="admin-card-icon">📦</div>
                                <h3>Заказы</h3>
                                <p id="total-orders-count">0 всего заказов</p>
                            </div>
                            <div class="admin-card" onclick="showAdminTab('assign-driver')">
                                <div class="admin-card-icon">🚚</div>
                                <h3>Назначить водителя</h3>
                                <p id="unassigned-orders-count">0 заказов без водителя</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Вкладка "Заявки водителей" -->
                    <div id="admin-driver-applications" class="profile-tab" style="display: none;">
                        <div id="driver-applications-list" class="admin-table-container">
                            <!-- Список заявок водителей -->
                        </div>
                    </div>
                    
                    <!-- Вкладка "Водители" -->
                    <div id="admin-drivers" class="profile-tab" style="display: none;">
                        <div id="drivers-list" class="admin-table-container">
                            <!-- Список водителей -->
                        </div>
                    </div>
                    
                    <!-- Вкладка "Заказы" -->
                    <div id="admin-orders" class="profile-tab" style="display: none;">
                        <!-- Фильтры заказов -->
                        <div class="filters-section">
                            <div class="filter-row">
                                <div class="filter-group">
                                    <label for="admin-status-filter">Статус:</label>
                                    <select id="admin-status-filter" onchange="filterAdminOrders()">
                                        <option value="all">Все заказы</option>
                                        <option value="new">Новые</option>
                                        <option value="confirmed">Подтвержденные</option>
                                        <option value="in_transit">В пути</option>
                                        <option value="delivered">Доставленные</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label for="admin-driver-filter">Водитель:</label>
                                    <select id="admin-driver-filter" onchange="filterAdminOrders()">
                                        <option value="all">Все водители</option>
                                        <option value="unassigned">Без водителя</option>
                                    </select>
                                </div>
                                <div class="filter-group reset-group">
                                    <button class="reset-btn" onclick="resetAdminFilters()">Сбросить</button>
                                </div>
                            </div>
                        </div>
                        
                        <div id="admin-orders-list" class="orders-table-container">
                            <!-- Список всех заказов -->
                        </div>
                    </div>
                    
                    <!-- Вкладка "Назначить водителя" -->
                    <div id="admin-assign-driver" class="profile-tab" style="display: none;">
                        <div id="assign-driver-content">
                            <!-- Контент для назначения водителя -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Подвал сайта -->
    <footer>
        <p>&copy; 2025 TransportCo. Все права защищены.</p>
    </footer>

    <!-- Модальное окно авторизации -->
    <div id="loginModal" class="modal">
        <div class="auth-container">
            <div class="auth-header">
                <button class="close-auth-btn" onclick="closeLoginModal()">×</button>
                <div class="auth-logo">TransportCo</div>
                <div class="auth-subtitle">Вход в аккаунт</div>
            </div>
            
            <div class="auth-form-container">
                <div class="auth-input-group">
                    <label for="auth-login">Телефон или Email</label>
                    <input class="auth-input" type="text" id="auth-login" placeholder="+7 930 913 78 79 или your@email.com">
                    <div class="error-message" id="auth-login-error"></div>
                </div>
                
                <div class="auth-input-group">
                    <label for="auth-password">Пароль</label>
                    <input class="auth-input" type="password" id="auth-password" placeholder="......">
                    <div class="error-message" id="auth-password-error"></div>
                </div>
                
                <div class="auth-options-row">
                    <label class="auth-checkbox-container">
                        <input type="checkbox" id="auth-rememberMe">
                        <span class="auth-custom-checkbox">
                            <span class="auth-checkmark"></span>
                        </span>
                        <span class="auth-checkbox-text">Запомнить меня</span>
                    </label>
                    <a class="auth-forgot-password" onclick="openForgotPasswordModal()">Забыли пароль?</a>
                </div>
                
                <button class="auth-btn" onclick="handleLogin()">Войти</button>
                
                <div class="auth-link">
                    Нет аккаунта? <a onclick="switchToRegister()">Зарегистрироваться</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Модальное окно регистрации -->
    <div id="registerModal" class="modal">
        <div class="auth-container">
            <div class="auth-header">
                <button class="close-auth-btn" onclick="closeRegisterModal()">×</button>
                <div class="auth-logo">TransportCo</div>
                <div class="auth-subtitle">Создание аккаунта</div>
            </div>
            
            <div class="auth-form-container">
                <div class="auth-row">
                    <div class="auth-input-group">
                        <label for="reg-firstName">Имя</label>
                        <input class="auth-input" type="text" id="reg-firstName" placeholder="Иван">
                        <div class="error-message" id="reg-firstName-error"></div>
                    </div>
                    <div class="auth-input-group">
                        <label for="reg-lastName">Фамилия</label>
                        <input class="auth-input" type="text" id="reg-lastName" placeholder="Иванов">
                        <div class="error-message" id="reg-lastName-error"></div>
                    </div>
                </div>
                
                <div class="auth-input-group">
                    <label for="reg-email">Email</label>
                    <input class="auth-input" type="email" id="reg-email" placeholder="your@email.com">
                    <div class="error-message" id="reg-email-error"></div>
                </div>
                
                <div class="auth-input-group">
                    <label for="reg-phone">Телефон</label>
                    <input class="auth-input" type="tel" id="reg-phone" placeholder="+7 (812) 156-43-89">
                    <div class="error-message" id="reg-phone-error"></div>
                </div>
                
                <div class="auth-input-group">
                    <label for="reg-password">Пароль</label>
                    <input class="auth-input" type="password" id="reg-password" placeholder="......">
                    <div class="error-message" id="reg-password-error"></div>
                </div>
                
                <div class="auth-input-group">
                    <label for="reg-confirmPassword">Подтвердить пароль</label>
                    <input class="auth-input" type="password" id="reg-confirmPassword" placeholder="......">
                    <div class="error-message" id="reg-confirmPassword-error"></div>
                </div>
                
                <label class="auth-checkbox-container">
                    <input type="checkbox" id="reg-agreeTerms">
                    <span class="auth-custom-checkbox">
                        <span class="auth-checkmark"></span>
                    </span>
                    <span class="auth-checkbox-text">Я согласен с условиями использования и политикой конфиденциальности.</span>
                </label>
                
                <button class="auth-btn register-btn" onclick="handleRegister()">Зарегистрироваться</button>
                
                <div class="auth-link">
                    Уже есть аккаунт? <a onclick="switchToLogin()">Войти</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Модальное окно подтверждения телефона при регистрации -->
    <div id="confirmRegisterCodeModal" class="modal">
        <div class="auth-container">
            <div class="auth-header">
                <button class="close-auth-btn" onclick="closeConfirmRegisterCodeModal()">×</button>
                <div class="auth-logo">TransportCo</div>
                <div class="auth-subtitle">Подтвердите телефон</div>
            </div>
            
            <div class="auth-form-container">
                <div class="sms-code-info">
                    На ваш телефон было отправлено<br>CМС-сообщение с кодом подтверждения.
                </div>
                
                <div class="auth-input-group">
                    <label for="reg-sms-code" style="text-align: center; display: block;">КОД ИЗ СМС</label>
                    <div class="sms-code-input">
                        <input type="text" id="reg-sms-code-1" maxlength="1" oninput="moveToNextRegister(1, event)">
                        <input type="text" id="reg-sms-code-2" maxlength="1" oninput="moveToNextRegister(2, event)">
                        <input type="text" id="reg-sms-code-3" maxlength="1" oninput="moveToNextRegister(3, event)">
                        <input type="text" id="reg-sms-code-4" maxlength="1" oninput="moveToNextRegister(4, event)">
                    </div>
                </div>
                
                <div class="sms-timer" id="reg-sms-timer">
                    Пожалуйста подождите... 59 сек
                </div>
                
                <div class="divider"></div>
                
                <div class="resend-code disabled" id="reg-resend-code">
                    Не приходит код? <a onclick="resendRegisterCode()">Отправить снова</a>
                </div>
                
                <div class="confirm-code-buttons">
                    <button class="continue-btn" onclick="verifyRegisterCode()">Подтвердить регистрацию</button>
                    <button class="back-btn" onclick="backToRegister()">Назад</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Модальное окно восстановления пароля (шаг 1) -->
    <div id="forgotPasswordModal" class="modal">
        <div class="auth-container">
            <div class="auth-header">
                <button class="close-auth-btn" onclick="closeForgotPasswordModal()">×</button>
                <div class="auth-logo">TransportCo</div>
                <div class="auth-subtitle">Восстановление пароля</div>
            </div>
            
            <div class="auth-form-container">
                <div class="forgot-password-info">
                    Введите номер мобильного телефона или e-mail, который вы использовали при регистрации
                </div>
                
                <div class="auth-input-group">
                    <label for="recovery-contact">ТЕЛЕФОН ИЛИ E-MAIL</label>
                    <input class="auth-input" type="text" id="recovery-contact" placeholder="Номер мобильного телефона или e-mail*" required>
                </div>
                
                <div class="forgot-password-buttons">
                    <button class="back-btn" onclick="closeForgotPasswordModal()">Назад</button>
                    <button class="recovery-btn" onclick="sendRecoveryCode()">Восстановить пароль</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Модальное окно подтверждения телефона (шаг 2) -->
    <div id="confirmCodeModal" class="modal">
        <div class="auth-container">
            <div class="auth-header">
                <button class="close-auth-btn" onclick="closeConfirmCodeModal()">×</button>
                <div class="auth-logo">TransportCo</div>
                <div class="auth-subtitle">Подтвердите телефон</div>
            </div>
            
            <div class="auth-form-container">
                <div class="sms-code-info">
                    На ваш телефон было отправлено<br>CМС-сообщение с кодом подтверждения.
                </div>
                
                <div class="auth-input-group">
                    <label for="sms-code" style="text-align: center; display: block;">КОД ИЗ СМС</label>
                    <div class="sms-code-input">
                        <input type="text" id="sms-code-1" maxlength="1" oninput="moveToNext(1, event)">
                        <input type="text" id="sms-code-2" maxlength="1" oninput="moveToNext(2, event)">
                        <input type="text" id="sms-code-3" maxlength="1" oninput="moveToNext(3, event)">
                        <input type="text" id="sms-code-4" maxlength="1" oninput="moveToNext(4, event)">
                    </div>
                </div>
                
                <div class="sms-timer" id="sms-timer">
                    Пожалуйста подождите... 59 сек
                </div>
                
                <div class="divider"></div>
                
                <div class="resend-code disabled" id="resend-code">
                    Не приходит код? <a onclick="resendCode()">Отправить снова</a>
                </div>
                
                <div class="confirm-code-buttons">
                    <button class="continue-btn" onclick="verifyCode()">Продолжить</button>
                    <button class="back-btn" onclick="backToForgotPassword()">Назад</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Модальное окно просмотра заказа (админ) -->
    <div id="viewOrderModal" class="admin-modal">
        <div class="admin-modal-content">
            <div class="admin-modal-header">
                <button class="close-admin-modal" onclick="closeViewOrderModal()">×</button>
                <h2>Детали заказа</h2>
            </div>
            <div class="admin-modal-body" id="order-details-content">
                <!-- Детали заказа -->
            </div>
        </div>
    </div>

    <!-- Модальное окно назначения водителя -->
    <div id="assignDriverModal" class="admin-modal">
        <div class="admin-modal-content">
            <div class="admin-modal-header">
                <button class="close-admin-modal" onclick="closeAssignDriverModal()">×</button>
                <h2>Назначить водителя</h2>
            </div>
            <div class="admin-modal-body">
                <div class="order-form-group">
                    <label for="select-driver">Выберите водителя:</label>
                    <select id="select-driver" class="auth-input">
                        <option value="">Выберите водителя...</option>
                    </select>
                </div>
                <div class="forgot-password-buttons">
                    <button class="back-btn" onclick="closeAssignDriverModal()">Отмена</button>
                    <button class="recovery-btn" onclick="assignDriverToOrder()">Назначить</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Расширенная модель данных
        
        // 1. Расширяем модель пользователя
        let users = JSON.parse(localStorage.getItem('transportco_users')) || [
            {
                id: 1,
                email: "test@example.com",
                phone: "+79123456789",
                password: "password123",
                firstName: "Иван",
                lastName: "Иванов",
                verified: true,
                role: "client" // client, driver, admin
            },
            {
                id: 2,
                email: "admin@transportco.ru",
                phone: "+79123456780",
                password: "admin123",
                firstName: "Админ",
                lastName: "Админов",
                verified: true,
                role: "admin"
            },
            {
                id: 3,
                email: "driver@transportco.ru",
                phone: "+79123456781",
                password: "driver123",
                firstName: "Петр",
                lastName: "Петров",
                verified: true,
                role: "driver",
                driverData: {
                    license: "78XX123456",
                    experience: 5,
                    vehicleType: "truck",
                    rating: 4.8,
                    deliveredOrders: 24,
                    totalMileage: 15000,
                    status: "active"
                }
            }
        ];
        
        // 2. Добавляем заявки водителей
        let driverApplications = JSON.parse(localStorage.getItem('transportco_driver_apps')) || [];
        
        // 3. Расширяем модель заказа
        let orders = JSON.parse(localStorage.getItem('transportco_orders')) || [];
        
        // Текущий пользователь
        let currentUser = JSON.parse(localStorage.getItem('transportco_currentUser')) || null;
        
        // Запоминаем ID заказа для назначения водителя
        let orderToAssign = null;
        
        // База расстояний между городами (в км)
        const cityDistances = {
            // Центральный регион
            'Москва': {
                'Санкт-Петербург': 714,
                'Кострома': 346,
                'Ярославль': 274,
                'Владимир': 194,
                'Казань': 807,
                'Нижний Новгород': 416,
                'Екатеринбург': 1745,
                'Новосибирск': 3350,
                'Сочи': 1584
            },
            'Санкт-Петербург': {
                'Москва': 710,
                'Кострома': 860,
                'Ярославль': 800,
                'Великий Новгород': 180,
                'Псков': 280,
                'Мурманск': 1400
            },
            'Кострома': {
                'Москва': 340,
                'Санкт-Петербург': 860,
                'Ярославль': 85,
                'Иваново': 110,
                'Нижний Новгород': 330,
                'Вологда': 220
            },
            'Ярославль': {
                'Москва': 280,
                'Санкт-Петербург': 800,
                'Кострома': 85,
                'Вологда': 200,
                'Рыбинск': 75
            }
        };

        // Функция для расчета расстояния между городами
        function calculateDistance(city1, city2) {
            if (!city1 || !city2) return 100; // Значение по умолчанию
            
            const normalizedCity1 = normalizeCityName(city1);
            const normalizedCity2 = normalizeCityName(city2);
            
            if (normalizedCity1 === normalizedCity2) {
                return 10; // Внутри города
            }
            
            // Проверяем в обе стороны
            if (cityDistances[normalizedCity1] && cityDistances[normalizedCity1][normalizedCity2]) {
                return cityDistances[normalizedCity1][normalizedCity2];
            }
            
            if (cityDistances[normalizedCity2] && cityDistances[normalizedCity2][normalizedCity1]) {
                return cityDistances[normalizedCity2][normalizedCity1];
            }
            
            // Если города не найдены в базе, используем эмпирическую формулу
            return calculateEstimatedDistance(normalizedCity1, normalizedCity2);
        }

        // Функция для нормализации названия города
        function normalizeCityName(city) {
            if (!city) return '';
            
            // Удаляем лишние пробелы, приводим к нижнему регистру
            const normalized = city.trim().toLowerCase();
            
            // Ищем соответствие в базе городов
            const knownCities = Object.keys(cityDistances);
            const found = knownCities.find(knownCity => 
                knownCity.toLowerCase().includes(normalized) || 
                normalized.includes(knownCity.toLowerCase())
            );
            
            return found || city.trim();
        }

        // Эмпирическая формула для расчета расстояния
        function calculateEstimatedDistance(city1, city2) {
            // Простой эвристический расчет на основе первых букв
            // В реальном проекте здесь должен быть API расчета расстояний
            const baseDistance = 500; // Среднее расстояние по умолчанию
            
            // Простая эвристика: если города из одного региона
            const russianRegions = {
                'москва': 'центральный',
                'кострома': 'центральный', 
                'ярославль': 'центральный',
                'санкт-петербург': 'северо-западный',
                'новгород': 'северо-западный',
                'казань': 'приволжский',
                'нижний новгород': 'приволжский',
                'екатеринбург': 'уральский',
                'новосибирск': 'сибирский',
                'сочи': 'южный'
            };
            
            const region1 = russianRegions[city1.toLowerCase()] || 'центральный';
            const region2 = russianRegions[city2.toLowerCase()] || 'центральный';
            
            if (region1 === region2) {
                return Math.floor(Math.random() * 300) + 100; // 100-400 км в одном регионе
            } else {
                return Math.floor(Math.random() * 1500) + 500; // 500-2000 км между регионами
            }
        }
        
        // Временные данные для регистрации
        let tempRegistrationData = null;
        
        // Переменная для запоминания страницы после авторизации
        let pendingPageAfterLogin = null;

        // Система уведомлений
        function showNotification(message, type = 'info', duration = 5000) {
            const container = document.getElementById('notificationContainer');
            
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            
            notification.innerHTML = `
                <div class="notification-content">${message}</div>
                <button class="notification-close" onclick="this.parentElement.remove()">×</button>
            `;
            
            container.appendChild(notification);
            
            // Автоматическое удаление через указанное время
            if (duration > 0) {
                setTimeout(() => {
                    if (notification.parentElement) {
                        notification.classList.add('hiding');
                        setTimeout(() => {
                            if (notification.parentElement) {
                                notification.remove();
                            }
                        }, 300);
                    }
                }, duration);
            }
            
            return notification;
        }
        
        // Функция для обновления интерфейса в зависимости от роли
        function updateUIForRole() {
            const driverLink = document.getElementById('driver-link');
            const adminLink = document.getElementById('admin-link');
            const becomeDriverTab = document.getElementById('become-driver-tab');
            
            if (currentUser) {
                if (currentUser.role === 'driver') {
                    driverLink.style.display = 'block';
                    becomeDriverTab.style.display = 'none';
                } else if (currentUser.role === 'admin') {
                    adminLink.style.display = 'block';
                    becomeDriverTab.style.display = 'none';
                } else if (currentUser.role === 'client') {
                    // Проверяем, есть ли уже заявка
                    const hasApplication = driverApplications.some(app => app.userId === currentUser.id);
                    if (!hasApplication) {
                        becomeDriverTab.style.display = 'block';
                    }
                }
            } else {
                driverLink.style.display = 'none';
                adminLink.style.display = 'none';
            }
        }
        
        // Функция для обработки заявки "Стать водителем"
        function handleDriverApplication(event) {
            event.preventDefault();
            
            if (!currentUser) {
                showNotification('Для подачи заявки необходимо войти в систему', 'warning');
                return false;
            }
            
            const license = document.getElementById('driver-license').value;
            const experience = document.getElementById('driver-experience').value;
            const vehicleType = document.getElementById('driver-vehicle-type').value;
            const phone = document.getElementById('driver-phone').value;
            const comment = document.getElementById('driver-comment').value;
            
            // Проверяем, нет ли уже заявки
            const existingApp = driverApplications.find(app => app.userId === currentUser.id);
            if (existingApp) {
                showNotification('Вы уже отправили заявку. Ожидайте решения администратора.', 'warning');
                return false;
            }
            
            // Создаем заявку
            const application = {
                id: driverApplications.length + 1,
                userId: currentUser.id,
                userName: `${currentUser.firstName} ${currentUser.lastName}`,
                userEmail: currentUser.email,
                license: license,
                experience: parseInt(experience),
                vehicleType: vehicleType,
                phone: phone,
                comment: comment,
                status: 'pending', // pending, approved, rejected
                createdAt: new Date().toISOString()
            };
            
            driverApplications.push(application);
            localStorage.setItem('transportco_driver_apps', JSON.stringify(driverApplications));
            
            // Обновляем статус на вкладке
            document.getElementById('driver-application-status').style.display = 'block';
            document.getElementById('driver-status-content').innerHTML = `
                <div class="order-status processing">
                    <span class="status-icon">●</span>
                    <span>На рассмотрении</span>
                </div>
                <p style="margin-top: 15px;">Ваша заявка отправлена. Администратор рассмотрит её в ближайшее время.</p>
            `;
            
            showNotification('Заявка успешно отправлена!', 'success');
            
            // Скрываем форму
            document.getElementById('driver-application-form').style.display = 'none';
            
            // Обновляем статистику для админа (если админ онлайн)
            if (currentUser.role === 'admin') {
                updateAdminStats();
            }
            
            return false;
        }
        
        // Функция для переключения страниц
        function showPage(pageId) {
            // Проверяем авторизацию для доступа к профилю и заказу
            if ((pageId === 'profile' || pageId === 'order') && !currentUser) {
                if (pageId === 'order') {
                    showNotification('Для оформления заказа необходимо войти в аккаунт', 'warning');
                    pendingPageAfterLogin = 'order'; // Запоминаем, куда перейти после входа
                } else {
                    showNotification('Для доступа к профилю необходимо авторизоваться', 'warning');
                    pendingPageAfterLogin = 'profile';
                }
                openLoginModal();
                return;
            }
            
            // Проверяем права доступа для водительской и админской панели
            if (pageId === 'driver' && currentUser && currentUser.role !== 'driver') {
                showNotification('Доступно только для водителей', 'error');
                showPage('profile');
                return;
            }
            
            if (pageId === 'admin' && currentUser && currentUser.role !== 'admin') {
                showNotification('Доступно только для администраторов', 'error');
                showPage('profile');
                return;
            }
            
            // Скрыть все страницы
            const pages = document.querySelectorAll('.page-content');
            pages.forEach(page => {
                page.classList.remove('active');
            });
            
            // Показать выбранную страницу
            const pageElement = document.getElementById(pageId + '-page');
            if (pageElement) {
                pageElement.classList.add('active');
            }
            
            // Обновить активную ссылку в навигации
            const navLinks = document.querySelectorAll('nav a');
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.textContent === getPageName(pageId)) {
                    link.classList.add('active');
                }
            });
            
            // Прокрутить вверх
            window.scrollTo(0, 0);
            
            // Если показываем страницу профиля, показываем вкладку "Данные"
            if (pageId === 'profile') {
                showProfileTab('data');
            }
            
            // Если показываем страницу водителя, загружаем доступные заказы
            if (pageId === 'driver') {
                showDriverTab('available');
            }
            
            // Если показываем страницу админа, показываем dashboard
            if (pageId === 'admin') {
                showAdminTab('dashboard');
            }
        }
        
        // Функция для получения названия страницы по ID
        function getPageName(pageId) {
            const pageNames = {
                'main': 'Главная',
                'about': 'О компании',
                'contacts': 'Контакты',
                'profile': 'Профиль',
                'order': 'Заказать перевозку',
                'driver': 'Водителю',
                'admin': 'Админ'
            };
            
            return pageNames[pageId] || 'Главная';
        }
        
        // Функция переключения вкладок профиля
        function showProfileTab(tabName) {
            // Убираем активный класс у всех кнопок
            const navButtons = document.querySelectorAll('.profile-nav-btn');
            navButtons.forEach(btn => btn.classList.remove('active'));
            
            // Добавляем активный класс нажатой кнопке
            document.querySelector(`.profile-nav-btn[onclick*="${tabName}"]`).classList.add('active');
            
            // Скрываем все вкладки
            const tabs = document.querySelectorAll('.profile-tab');
            tabs.forEach(tab => tab.style.display = 'none');
            
            // Показываем выбранную вкладку
            document.getElementById(`profile-${tabName}`).style.display = 'block';
            
            // Если открыли вкладку заказов, обновляем статистику
            if (tabName === 'orders') {
                updateProfileOrderStats();
            }
        }
        
        // Функция обновления статистики заказов в профиле
        function updateProfileOrderStats() {
            if (!currentUser) return;
            
            // Фильтруем заказы текущего пользователя
            const userOrders = orders.filter(order => order.userId === currentUser.id);
            
            // Обновляем статистику
            document.getElementById('profile-total-orders-count').textContent = userOrders.length;
            
            // Статусы "new", "confirmed" и "processing" теперь все "В обработке"
            const processingOrders = userOrders.filter(o => 
                o.status === 'new' || 
                o.status === 'confirmed' || 
                o.status === 'processing'
            ).length;
            
            document.getElementById('profile-processing-orders-count').textContent = processingOrders;
            document.getElementById('profile-in-transit-orders-count').textContent = userOrders.filter(o => o.status === 'in_transit').length;
            document.getElementById('profile-delivered-orders-count').textContent = userOrders.filter(o => o.status === 'delivered').length;
            
            // Загружаем заказы пользователя
            if (userOrders.length > 0) {
                displayUserOrders(userOrders);
                toggleOrdersVisibility(true);
            } else {
                toggleOrdersVisibility(false);
            }
        }
        
        // Функция отображения заказов пользователя
        function displayUserOrders(orders) {
            const ordersTable = document.getElementById('profile-orders-table');
            const tableBody = ordersTable.querySelector('tbody') || document.createElement('tbody');
            tableBody.innerHTML = '';
            
            orders.forEach((order, index) => {
                const row = document.createElement('div');
                row.className = 'order-row';
                
                // Форматирование даты
                const orderDate = new Date(order.createdAt);
                const formattedDate = orderDate.toLocaleDateString('ru-RU', {
                    day: 'numeric',
                    month: 'short',
                    year: 'numeric'
                });

                // Форматирование даты отправления (shippingDate)
                const shippingDate = new Date(order.shippingDate);
                const formattedShippingDate = shippingDate.toLocaleDateString('ru-RU', {
                    day: 'numeric',
                    month: 'short',
                    year: 'numeric'
                });
                
                // Определение статуса
                const statusClass = getStatusClass(order.status);
                const statusText = getStatusText(order.status);
                
                row.innerHTML = `
                    <div class="order-cell order-id" data-label="№ заказа">
                        <span class="order-id-text">#${index + 1}</span>
                    </div>
                    <div class="order-cell date-container" data-label="Дата заявки">
                        <span class="date-day">${formattedDate}</span>
                    </div>
                    <div class="order-cell date-container order-shipping-date-cell" data-label="Дата отправки">
                        <span class="date-day">${formattedShippingDate}</span>
                    </div>
                    <div class="order-cell address-container" data-label="Адрес отправления">
                        <span class="address-line">${order.pickupAddress || 'Не указан'}</span>
                    </div>
                    <div class="order-cell address-container" data-label="Адрес доставки">
                        <span class="address-line">${order.deliveryAddress || 'Не указан'}</span>
                    </div>
                    <div class="order-cell" data-label="Груз">
                        <span class="cargo-text">${order.cargoDescription || 'Не указан'}</span>
                    </div>
                    <div class="order-cell order-category-cell" data-label="Категория">
                        <span>${getCategoryName(order.productCategory) || 'Не указана'}</span>
                    </div>
                    <div class="order-cell order-status-cell" data-label="Статус">
                        <div class="order-status ${statusClass}">
                            <span class="status-icon">●</span>
                            <span>${statusText}</span>
                        </div>
                    </div>
                    <div class="order-cell" data-label="Расстояние">
                        <span>${order.distance ? order.distance + ' км' : 'Не указано'}</span>
                    </div>
                    <div class="order-cell order-price-cell" data-label="Цена">
                        <span class="order-price">${order.price ? `${order.price} ₽` : 'Рассчитывается'}</span>
                    </div>
                    <div class="order-cell order-actions-cell" data-label="Действия">
                        <div class="actions-container">
                            <div class="order-buttons">
                                <button class="view-btn" onclick="viewOrder('${order.id}')">Подробнее</button>
                                <button class="track-btn" onclick="trackOrder('${order.id}')">Отследить</button>
                            </div>
                        </div>
                    </div>
                `;
                
                tableBody.appendChild(row);
            });
            
            if (!ordersTable.querySelector('tbody')) {
                ordersTable.appendChild(tableBody);
            }
        }
        
        // Вспомогательные функции для статусов
        function getStatusClass(status) {
            const statusMap = {
                'new': 'processing',
                'confirmed': 'processing',
                'processing': 'processing',
                'in_transit': 'in-transit',
                'delivered': 'delivered',
                'cancelled': 'cancelled'
            };
            return statusMap[status] || 'processing';
        }
        
        function getStatusText(status) {
            const statusTextMap = {
                'new': 'В обработке',
                'confirmed': 'В обработке',
                'processing': 'В обработке',
                'in_transit': 'В пути',
                'delivered': 'Доставлен',
                'cancelled': 'Отменен'
            };
            return statusTextMap[status] || 'В обработке';
        }

        // Функция для получения читаемого названия категории
        function getCategoryName(categoryCode) {
        const categoryMap = {
            'electronics': 'Электроника',
            'clothing': 'Одежда и обувь',
            'furniture': 'Мебель',
            'food': 'Продукты питания',
            'building': 'Стройматериалы',
            'auto': 'Автозапчасти',
            'industrial': 'Оборудование',
            'chemicals': 'Химические вещества',
            'documents': 'Документы',
            'other': 'Другое'
        }
    return categoryMap[categoryCode] || categoryCode;
}
        
        // Функция сброса фильтров в профиле
        function resetProfileFilters() {
            document.getElementById('profile-status-filter').value = 'Все заказы';
            document.getElementById('profile-period-filter').value = 'Все время';
            document.getElementById('profile-search-input').value = '';
            updateProfileOrderStats();
        }
        
        // Функция фильтрации заказов в профиле
        function filterProfileOrders() {
            if (!currentUser) return;
            
            const status = document.getElementById('profile-status-filter').value;
            const period = document.getElementById('profile-period-filter').value;
            const search = document.getElementById('profile-search-input').value.toLowerCase();
            
            // Фильтруем заказы пользователя
            let filteredOrders = orders.filter(order => order.userId === currentUser.id);
            
            // Фильтр по статусу
            if (status && status !== 'Все заказы') {
                if (status === 'В обработке') {
                    // Фильтруем и "new", и "confirmed", и "processing" как "В обработке"
                    filteredOrders = filteredOrders.filter(order => 
                        order.status === 'new' || 
                        order.status === 'confirmed' || 
                        order.status === 'processing'
                    );
                } else {
                    const statusMap = {
                        'В пути': 'in_transit',
                        'Доставлен': 'delivered',
                        'Отменен': 'cancelled'
                    };
                    filteredOrders = filteredOrders.filter(order => order.status === statusMap[status]);
                }
            }
            
            // Фильтр по периоду
            if (period && period !== 'Все время') {
                const now = new Date();
                let startDate = new Date();
                
                switch(period) {
                    case 'За неделю':
                        startDate.setDate(now.getDate() - 7);
                        break;
                    case 'За месяц':
                        startDate.setMonth(now.getMonth() - 1);
                        break;
                    case 'За 3 месяца':
                        startDate.setMonth(now.getMonth() - 3);
                        break;
                    case 'За год':
                        startDate.setFullYear(now.getFullYear() - 1);
                        break;
                }
                
                filteredOrders = filteredOrders.filter(order => {
                    const orderDate = new Date(order.createdAt);
                    return orderDate >= startDate;
                });
            }
            
            // Поиск
            if (search) {
                filteredOrders = filteredOrders.filter(order => 
                    order.id.toString().includes(search) ||
                    (order.pickupAddress && order.pickupAddress.toLowerCase().includes(search)) ||
                    (order.deliveryAddress && order.deliveryAddress.toLowerCase().includes(search)) ||
                    (order.cargoDescription && order.cargoDescription.toLowerCase().includes(search))
                );
            }
            
            if (filteredOrders.length > 0) {
                displayUserOrders(filteredOrders);
                toggleOrdersVisibility(true);
            } else {
                toggleOrdersVisibility(false);
            }
        }
        
        // Обработчик формы профиля
        function handleProfileSubmit(event) {
            event.preventDefault();
            
            if (!currentUser) {
                showNotification('Для изменения профиля необходимо авторизоваться', 'warning');
                return false;
            }
            
            const currentPassword = document.getElementById('profile-current-password').value;
            const newPassword = document.getElementById('profile-new-password').value;
            const confirmPassword = document.getElementById('profile-confirm-password').value;
            
            // Проверка на смену пароля
            if (currentPassword || newPassword || confirmPassword) {
                if (newPassword !== confirmPassword) {
                    showNotification('Новый пароль и подтверждение не совпадают', 'error');
                    return false;
                }
                if (newPassword.length < 6) {
                    showNotification('Новый пароль должен содержать минимум 6 символов', 'error');
                    return false;
                }
                
                // Проверяем текущий пароль
                if (currentPassword !== currentUser.password) {
                    showNotification('Текущий пароль указан неверно', 'error');
                    return false;
                }
                
                // Обновляем пароль пользователя
                currentUser.password = newPassword;
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                if (userIndex !== -1) {
                    users[userIndex].password = newPassword;
                    localStorage.setItem('transportco_users', JSON.stringify(users));
                    localStorage.setItem('transportco_currentUser', JSON.stringify(currentUser));
                }
                
                showNotification('Пароль успешно изменен!', 'success');
                
                // Очищаем поля пароля
                document.getElementById('profile-current-password').value = '';
                document.getElementById('profile-new-password').value = '';
                document.getElementById('profile-confirm-password').value = '';
            }
            
            showNotification('Изменения сохранены!', 'success');
            return false;
        }
        
        // Функция для имитации авторизации
        function loginUser() {
            document.getElementById('unauth-buttons').style.display = 'none';
            document.getElementById('auth-user-buttons').style.display = 'flex';
            
            // Обновляем данные профиля
            if (currentUser) {
                document.getElementById('profile-first-name').value = currentUser.firstName || '';
                document.getElementById('profile-last-name').value = currentUser.lastName || '';
                document.getElementById('profile-email').value = currentUser.email || '';
                document.getElementById('profile-phone').value = currentUser.phone || '';
                
                // Проверяем заявку на водителя
                const hasApplication = driverApplications.some(app => 
                    app.userId === currentUser.id && 
                    app.status === 'pending'
                );
                
                if (hasApplication && currentUser.role === 'client') {
                    document.getElementById('driver-application-status').style.display = 'block';
                    document.getElementById('driver-status-content').innerHTML = `
                        <div class="order-status processing">
                            <span class="status-icon">●</span>
                            <span>На рассмотрении</span>
                        </div>
                        <p style="margin-top: 15px;">Ваша заявка на водителя находится на рассмотрении администратора.</p>
                    `;
                    document.getElementById('driver-application-form').style.display = 'none';
                }
            }
            
            // Обновляем интерфейс в зависимости от роли
            updateUIForRole();
        }
        
        function logout() {
            currentUser = null;
            localStorage.removeItem('transportco_currentUser');
            document.getElementById('unauth-buttons').style.display = 'flex';
            document.getElementById('auth-user-buttons').style.display = 'none';
            showPage('main');
            showNotification('Вы успешно вышли из системы', 'info');
        }
        
        // ФУНКЦИИ ДЛЯ ВОДИТЕЛЯ
        
        // Функция для отображения вкладки водителя
        function showDriverTab(tabName) {
            // Убираем активный класс у всех кнопок
            const navButtons = document.querySelectorAll('.role-nav-btn');
            navButtons.forEach(btn => btn.classList.remove('active'));
            
            // Добавляем активный класс нажатой кнопке
            document.querySelector(`.role-nav-btn[onclick*="${tabName}"]`).classList.add('active');
            
            // Скрываем все вкладки водителя
            const tabs = ['driver-available', 'driver-my-orders', 'driver-history', 'driver-profile'];
            tabs.forEach(tab => {
                const tabElement = document.getElementById(tab);
                if (tabElement) tabElement.style.display = 'none';
            });
            
            // Показываем выбранную вкладку
            const tabElement = document.getElementById(`driver-${tabName}`);
            if (tabElement) {
                tabElement.style.display = 'block';
                
                // Обновляем данные в зависимости от вкладки
                switch(tabName) {
                    case 'available':
                        loadAvailableOrders();
                        updateDriverStats();
                        break;
                    case 'my-orders':
                        loadDriverActiveOrders();
                        break;
                    case 'history':
                        loadDriverHistory();
                        break;
                    case 'profile':
                        loadDriverProfile();
                        break;
                }
            }
        }
        
        // Функция для загрузки доступных заказов (статус "confirmed")
        function loadAvailableOrders() {
            const availableOrders = orders.filter(order => 
                order.status === 'confirmed' && 
                (!order.driverId || order.driverId === currentUser.id)
            );
            
            const ordersList = document.getElementById('available-orders-list');
            ordersList.innerHTML = '';
            
            if (availableOrders.length === 0) {
                ordersList.innerHTML = `
                    <div class="no-orders-container">
                        <div class="no-orders-icon">📭</div>
                        <h3>Нет доступных заказов</h3>
                        <p>Все заказы уже приняты другими водителями</p>
                    </div>
                `;
                return;
            }
            
            // Создаем таблицу
            ordersList.innerHTML = `
                <div class="table-header">
                    <div class="table-header-item">№ ЗАКАЗА</div>
                    <div class="table-header-item">АДРЕС ОТПРАВЛЕНИЯ</div>
                    <div class="table-header-item">АДРЕС ДОСТАВКИ</div>
                    <div class="table-header-item">ГРУЗ</div>
                    <div class="table-header-item">РАССТОЯНИЕ</div>
                    <div class="table-header-item">ЦЕНА</div>
                    <div class="table-header-item">ДЕЙСТВИЯ</div>
                </div>
            `;
            
            availableOrders.forEach((order, index) => {
                const row = document.createElement('div');
                row.className = 'order-row';
                row.innerHTML = `
                    <div class="order-cell order-id" data-label="№ заказа">
                        <span class="order-id-text">#${order.id}</span>
                    </div>
                    <div class="order-cell address-container" data-label="Адрес отправления">
                        <span class="address-line">${order.pickupAddress || 'Не указан'}</span>
                    </div>
                    <div class="order-cell address-container" data-label="Адрес доставки">
                        <span class="address-line">${order.deliveryAddress || 'Не указан'}</span>
                    </div>
                    <div class="order-cell" data-label="Груз">
                        <span class="cargo-text">${order.cargoDescription || 'Не указан'}</span>
                    </div>
                    <div class="order-cell" data-label="Расстояние">
                        <span>${order.distance ? order.distance + ' км' : 'Не указано'}</span>
                    </div>
                    <div class="order-cell order-price-cell" data-label="Цена">
                        <span class="order-price">${order.price ? `${order.price} ₽` : 'Рассчитывается'}</span>
                    </div>
                    <div class="order-cell order-actions-cell" data-label="Действия">
                        <div class="actions-container">
                            <div class="order-buttons">
                                <button class="track-btn" onclick="viewOrderDetails(${order.id})">Подробнее</button>
                                <button class="btn-accept driver-btn" onclick="acceptOrder(${order.id})">Принять заказ</button>
                            </div>
                        </div>
                    </div>
                `;
                ordersList.appendChild(row);
            });
            
            // Обновляем счетчик
            document.getElementById('available-orders-count').textContent = availableOrders.length;
        }
        
        // Функция принятия заказа водителем
        function acceptOrder(orderId) {
            const orderIndex = orders.findIndex(o => o.id === orderId);
            if (orderIndex === -1) return;
            
            orders[orderIndex].status = 'in_transit';
            orders[orderIndex].driverId = currentUser.id;
            orders[orderIndex].acceptedAt = new Date().toISOString();
            
            localStorage.setItem('transportco_orders', JSON.stringify(orders));
            
            showNotification(`Заказ #${orderId} принят! Статус изменен на "В пути"`, 'success');
            
            // Обновляем списки
            loadAvailableOrders();
            loadDriverActiveOrders();
            updateDriverStats();
        }
        
        // Функция для загрузки активных заказов водителя
        function loadDriverActiveOrders() {
            const activeOrders = orders.filter(order => 
                order.driverId === currentUser.id && 
                (order.status === 'in_transit' || order.status === 'confirmed')
            );
            
            const ordersList = document.getElementById('active-orders-list');
            ordersList.innerHTML = '';
            
            if (activeOrders.length === 0) {
                ordersList.innerHTML = `
                    <div class="no-orders-container">
                        <div class="no-orders-icon">🚗</div>
                        <h3>Нет активных заказов</h3>
                        <p>Примите заказ из раздела "Доступные заказы"</p>
                    </div>
                `;
                return;
            }
            
            ordersList.innerHTML = `
                <div class="table-header">
                    <div class="table-header-item">№ ЗАКАЗА</div>
                    <div class="table-header-item">АДРЕС ОТПРАВЛЕНИЯ</div>
                    <div class="table-header-item">АДРЕС ДОСТАВКИ</div>
                    <div class="table-header-item">СТАТУС</div>
                    <div class="table-header-item">ДЕЙСТВИЯ</div>
                </div>
            `;
            
            activeOrders.forEach(order => {
                const statusClass = getStatusClass(order.status);
                const statusText = getStatusText(order.status);
                
                const row = document.createElement('div');
                row.className = 'order-row';
                row.innerHTML = `
                    <div class="order-cell order-id" data-label="№ заказа">
                        <span class="order-id-text">#${order.id}</span>
                    </div>
                    <div class="order-cell address-container" data-label="Адрес отправления">
                        <span class="address-line">${order.pickupAddress || 'Не указан'}</span>
                    </div>
                    <div class="order-cell address-container" data-label="Адрес доставки">
                        <span class="address-line">${order.deliveryAddress || 'Не указан'}</span>
                    </div>
                    <div class="order-cell order-status-cell" data-label="Статус">
                        <div class="order-status ${statusClass}">
                            <span class="status-icon">●</span>
                            <span>${statusText}</span>
                        </div>
                    </div>
                    <div class="order-cell order-actions-cell" data-label="Действия">
                        <div class="actions-container">
                            <div class="driver-actions">
                                ${order.status === 'confirmed' ? 
                                    `<button class="btn-picked driver-btn" onclick="markAsPickedUp(${order.id})">Груз принят</button>` : 
                                    `<button class="btn-delivered driver-btn" onclick="markAsDelivered(${order.id})">Доставлено</button>`
                                }
                            </div>
                        </div>
                    </div>
                `;
                ordersList.appendChild(row);
            });
            
            // Обновляем счетчик
            document.getElementById('my-active-orders').textContent = activeOrders.length;
        }
        
        // Функция отметки "Груз принят"
        function markAsPickedUp(orderId) {
            const orderIndex = orders.findIndex(o => o.id === orderId);
            if (orderIndex === -1) return;
            
            orders[orderIndex].status = 'in_transit';
            orders[orderIndex].pickedUpAt = new Date().toISOString();
            
            localStorage.setItem('transportco_orders', JSON.stringify(orders));
            
            showNotification(`Груз по заказу #${orderId} принят!`, 'success');
            loadDriverActiveOrders();
        }
        
        // Функция отметки "Доставлено"
        function markAsDelivered(orderId) {
            const orderIndex = orders.findIndex(o => o.id === orderId);
            if (orderIndex === -1) return;
            
            orders[orderIndex].status = 'delivered';
            orders[orderIndex].deliveredAt = new Date().toISOString();
            
            // Обновляем статистику водителя
            if (currentUser.driverData) {
                currentUser.driverData.deliveredOrders += 1;
                currentUser.driverData.totalMileage += (orders[orderIndex].distance || 0);
                
                // Обновляем пользователя в базе
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                if (userIndex !== -1) {
                    users[userIndex] = currentUser;
                    localStorage.setItem('transportco_users', JSON.stringify(users));
                    localStorage.setItem('transportco_currentUser', JSON.stringify(currentUser));
                }
            }
            
            localStorage.setItem('transportco_orders', JSON.stringify(orders));
            
            showNotification(`Заказ #${orderId} доставлен!`, 'success');
            loadDriverActiveOrders();
            loadDriverHistory();
            updateDriverStats();
            loadDriverProfile();
        }
        
        // Функция для загрузки истории доставок
        function loadDriverHistory() {
            const historyOrders = orders.filter(order => 
                order.driverId === currentUser.id && 
                order.status === 'delivered'
            );
            
            const historyList = document.getElementById('delivery-history');
            historyList.innerHTML = '';
            
            if (historyOrders.length === 0) {
                historyList.innerHTML = `
                    <div class="no-orders-container">
                        <div class="no-orders-icon">📊</div>
                        <h3>История доставок пуста</h3>
                        <p>Вы еще не доставили ни одного заказа</p>
                    </div>
                `;
                return;
            }
            
            historyList.innerHTML = `
                <div class="table-header">
                    <div class="table-header-item">№ ЗАКАЗА</div>
                    <div class="table-header-item">ДАТА ДОСТАВКИ</div>
                    <div class="table-header-item">МАРШРУТ</div>
                    <div class="table-header-item">РАССТОЯНИЕ</div>
                    <div class="table-header-item">ЦЕНА</div>
                </div>
            `;
            
            historyOrders.forEach(order => {
                const deliveryDate = new Date(order.deliveredAt || order.createdAt);
                const formattedDate = deliveryDate.toLocaleDateString('ru-RU', {
                    day: 'numeric',
                    month: 'short',
                    year: 'numeric'
                });
                
                const row = document.createElement('div');
                row.className = 'order-row';
                row.innerHTML = `
                    <div class="order-cell order-id" data-label="№ заказа">
                        <span class="order-id-text">#${order.id}</span>
                    </div>
                    <div class="order-cell date-container" data-label="Дата доставки">
                        <span class="date-day">${formattedDate}</span>
                    </div>
                    <div class="order-cell" data-label="Маршрут">
                        <span class="address-line">${order.pickupAddress} → ${order.deliveryAddress}</span>
                    </div>
                    <div class="order-cell" data-label="Расстояние">
                        <span>${order.distance ? order.distance + ' км' : 'Не указано'}</span>
                    </div>
                    <div class="order-cell order-price-cell" data-label="Цена">
                        <span class="order-price">${order.price ? `${order.price} ₽` : 'Рассчитывается'}</span>
                    </div>
                `;
                historyList.appendChild(row);
            });
        }
        
        // Функция для загрузки профиля водителя
        function loadDriverProfile() {
            if (!currentUser.driverData) return;
            
            document.getElementById('driver-profile-license').value = currentUser.driverData.license;
            document.getElementById('driver-profile-experience').value = `${currentUser.driverData.experience} лет`;
            
            const vehicleTypes = {
                'light': 'Легковой автомобиль',
                'van': 'Микроавтобус',
                'truck': 'Грузовой автомобиль',
                'refrigerator': 'Рефрижератор'
            };
            document.getElementById('driver-profile-vehicle').value = vehicleTypes[currentUser.driverData.vehicleType] || currentUser.driverData.vehicleType;
            
            document.getElementById('driver-profile-delivered').value = currentUser.driverData.deliveredOrders;
            document.getElementById('driver-profile-mileage').value = `${currentUser.driverData.totalMileage} км`;
            
            // Отображаем рейтинг звездами
            const ratingStars = document.getElementById('driver-rating-stars');
            ratingStars.innerHTML = '';
            const rating = currentUser.driverData.rating || 0;
            
            for (let i = 1; i <= 5; i++) {
                const star = document.createElement('span');
                star.className = i <= Math.floor(rating) ? 'star filled' : 'star';
                star.innerHTML = '★';
                ratingStars.appendChild(star);
            }
        }
        
        // Функция для обновления статистики водителя
        function updateDriverStats() {
            const availableOrders = orders.filter(order => order.status === 'confirmed');
            const activeOrders = orders.filter(order => 
                order.driverId === currentUser.id && 
                (order.status === 'in_transit' || order.status === 'confirmed')
            );
            
            document.getElementById('available-orders-count').textContent = availableOrders.length;
            document.getElementById('my-active-orders').textContent = activeOrders.length;
            
            if (currentUser.driverData) {
                document.getElementById('driver-rating').textContent = currentUser.driverData.rating;
            }
        }
        
        // ФУНКЦИИ АДМИНИСТРАТОРА
        
        // Функция для отображения вкладки администратора
        function showAdminTab(tabName) {
            // Убираем активный класс у всех кнопок
            const navButtons = document.querySelectorAll('.role-nav-btn');
            navButtons.forEach(btn => btn.classList.remove('active'));
            
            // Добавляем активный класс нажатой кнопке
            document.querySelector(`.role-nav-btn[onclick*="${tabName}"]`).classList.add('active');
            
            // Скрываем все вкладки администратора
            const tabs = ['admin-dashboard', 'admin-driver-applications', 'admin-drivers', 'admin-orders', 'admin-assign-driver'];
            tabs.forEach(tab => {
                const tabElement = document.getElementById(tab);
                if (tabElement) tabElement.style.display = 'none';
            });
            
            // Показываем выбранную вкладку
            const tabElement = document.getElementById(`admin-${tabName}`);
            if (tabElement) {
                tabElement.style.display = 'block';
                
                // Обновляем данные в зависимости от вкладки
                switch(tabName) {
                    case 'dashboard':
                        updateAdminStats();
                        break;
                    case 'driver-applications':
                        loadDriverApplications();
                        break;
                    case 'drivers':
                        loadDriversList();
                        break;
                    case 'orders':
                        loadAdminOrders();
                        break;
                    case 'assign-driver':
                        loadUnassignedOrders();
                        break;
                }
            }
        }
        
        // Функция для обновления статистики администратора
        function updateAdminStats() {
            const pendingApps = driverApplications.filter(app => app.status === 'pending');
            const activeDrivers = users.filter(user => user.role === 'driver' && user.driverData && user.driverData.status === 'active');
            const totalOrders = orders.length;
            const unassignedOrders = orders.filter(order => !order.driverId && order.status === 'confirmed');
            
            document.getElementById('pending-applications-count').textContent = `${pendingApps.length} ожидают рассмотрения`;
            document.getElementById('active-drivers-count').textContent = `${activeDrivers.length} активных водителей`;
            document.getElementById('total-orders-count').textContent = `${totalOrders} всего заказов`;
            document.getElementById('unassigned-orders-count').textContent = `${unassignedOrders.length} заказов без водителя`;
        }
        
        // Функция для загрузки заявок водителей
        function loadDriverApplications() {
            const pendingApps = driverApplications.filter(app => app.status === 'pending');
            
            const appsList = document.getElementById('driver-applications-list');
            appsList.innerHTML = '';
            
            if (pendingApps.length === 0) {
                appsList.innerHTML = `
                    <div class="no-orders-container">
                        <div class="no-orders-icon">✅</div>
                        <h3>Нет заявок на рассмотрении</h3>
                        <p>Все заявки обработаны</p>
                    </div>
                `;
                return;
            }
            
            appsList.innerHTML = `
                <div class="admin-table-header" style="grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr;">
                    <div class="table-header-item">ИМЯ</div>
                    <div class="table-header-item">ТЕЛЕФОН</div>
                    <div class="table-header-item">ПРАВА</div>
                    <div class="table-header-item">ОПЫТ</div>
                    <div class="table-header-item">ТРАНСПОРТ</div>
                    <div class="table-header-item">ДЕЙСТВИЯ</div>
                </div>
            `;
            
            pendingApps.forEach(app => {
                const row = document.createElement('div');
                row.className = 'admin-table-row';
                row.style.gridTemplateColumns = '1fr 1fr 1fr 1fr 1fr 1fr';
                row.innerHTML = `
                    <div class="admin-table-cell" data-label="Имя">
                        <strong>${app.userName}</strong><br>
                        <small>${app.userEmail}</small>
                    </div>
                    <div class="admin-table-cell" data-label="Телефон">
                        ${app.phone}
                    </div>
                    <div class="admin-table-cell" data-label="Права">
                        ${app.license}
                    </div>
                    <div class="admin-table-cell" data-label="Опыт">
                        ${app.experience} лет
                    </div>
                    <div class="admin-table-cell" data-label="Транспорт">
                        ${app.vehicleType}
                    </div>
                    <div class="admin-table-cell" data-label="Действия">
                        <div class="driver-actions">
                            <button class="btn-accept driver-btn" onclick="approveDriverApplication(${app.id})">Нанять</button>
                            <button class="btn-login driver-btn" onclick="rejectDriverApplication(${app.id})">Отклонить</button>
                        </div>
                    </div>
                `;
                appsList.appendChild(row);
            });
        }
        
        // Функция одобрения заявки водителя
        function approveDriverApplication(appId) {
            const appIndex = driverApplications.findIndex(app => app.id === appId);
            if (appIndex === -1) return;
            
            const application = driverApplications[appIndex];
            
            // Находим пользователя
            const userIndex = users.findIndex(u => u.id === application.userId);
            if (userIndex === -1) return;
            
            // Обновляем роль пользователя
            users[userIndex].role = 'driver';
            users[userIndex].driverData = {
                license: application.license,
                experience: application.experience,
                vehicleType: application.vehicleType,
                rating: 5.0, // Начальный рейтинг
                deliveredOrders: 0,
                totalMileage: 0,
                status: 'active'
            };
            
            // Обновляем статус заявки
            driverApplications[appIndex].status = 'approved';
            
            // Сохраняем изменения
            localStorage.setItem('transportco_users', JSON.stringify(users));
            localStorage.setItem('transportco_driver_apps', JSON.stringify(driverApplications));
            
            // Если это текущий пользователь, обновляем его данные
            if (currentUser && currentUser.id === application.userId) {
                currentUser = users[userIndex];
                localStorage.setItem('transportco_currentUser', JSON.stringify(currentUser));
                updateUIForRole();
            }
            
            showNotification(`Заявка от ${application.userName} одобрена! Пользователь стал водителем.`, 'success');
            
            // Обновляем списки
            loadDriverApplications();
            updateAdminStats();
            loadDriversList();
        }
        
        // Функция отклонения заявки водителя
        function rejectDriverApplication(appId) {
            const appIndex = driverApplications.findIndex(app => app.id === appId);
            if (appIndex === -1) return;
            
            const application = driverApplications[appIndex];
            driverApplications[appIndex].status = 'rejected';
            
            localStorage.setItem('transportco_driver_apps', JSON.stringify(driverApplications));
            
            showNotification(`Заявка от ${application.userName} отклонена.`, 'info');
            loadDriverApplications();
            updateAdminStats();
        }
        
        // Функция для загрузки списка водителей
        function loadDriversList() {
            const activeDrivers = users.filter(user => user.role === 'driver' && user.driverData);
            
            const driversList = document.getElementById('drivers-list');
            driversList.innerHTML = '';
            
            if (activeDrivers.length === 0) {
                driversList.innerHTML = `
                    <div class="no-orders-container">
                        <div class="no-orders-icon">👨‍✈️</div>
                        <h3>Нет активных водителей</h3>
                        <p>Одобрите заявки из раздела "Заявки водителей"</p>
                    </div>
                `;
                return;
            }
            
            driversList.innerHTML = `
                <div class="admin-table-header" style="grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr;">
                    <div class="table-header-item">ИМЯ</div>
                    <div class="table-header-item">ТЕЛЕФОН</div>
                    <div class="table-header-item">РЕЙТИНГ</div>
                    <div class="table-header-item">ДОСТАВКИ</div>
                    <div class="table-header-item">ПРОБЕГ</div>
                    <div class="table-header-item">СТАТУС</div>
                </div>
            `;
            
            activeDrivers.forEach(driver => {
                const row = document.createElement('div');
                row.className = 'admin-table-row';
                row.style.gridTemplateColumns = '1fr 1fr 1fr 1fr 1fr 1fr';
                
                // Создаем звезды рейтинга
                let starsHtml = '';
                const rating = driver.driverData.rating || 0;
                for (let i = 1; i <= 5; i++) {
                    starsHtml += i <= Math.floor(rating) ? '★' : '☆';
                }
                
                row.innerHTML = `
                    <div class="admin-table-cell" data-label="Имя">
                        <strong>${driver.firstName} ${driver.lastName}</strong><br>
                        <small>${driver.email}</small>
                    </div>
                    <div class="admin-table-cell" data-label="Телефон">
                        ${driver.phone}
                    </div>
                    <div class="admin-table-cell" data-label="Рейтинг">
                        ${starsHtml}<br>
                        <small>${rating.toFixed(1)}</small>
                    </div>
                    <div class="admin-table-cell" data-label="Доставки">
                        ${driver.driverData.deliveredOrders || 0}
                    </div>
                    <div class="admin-table-cell" data-label="Пробег">
                        ${driver.driverData.totalMileage || 0} км
                    </div>
                    <div class="admin-table-cell" data-label="Статус">
                        <span class="order-status delivered">Активен</span>
                    </div>
                `;
                driversList.appendChild(row);
            });
        }
        
        // Функция для загрузки всех заказов (админ)
        function loadAdminOrders() {
            const statusFilter = document.getElementById('admin-status-filter').value;
            const driverFilter = document.getElementById('admin-driver-filter').value;
            
            let filteredOrders = [...orders];
            
            // Фильтр по статусу
            if (statusFilter !== 'all') {
                filteredOrders = filteredOrders.filter(order => order.status === statusFilter);
            }
            
            // Фильтр по водителю
            if (driverFilter === 'unassigned') {
                filteredOrders = filteredOrders.filter(order => !order.driverId);
            }
            
            const ordersList = document.getElementById('admin-orders-list');
            ordersList.innerHTML = '';
            
            if (filteredOrders.length === 0) {
                ordersList.innerHTML = `
                    <div class="no-orders-container">
                        <div class="no-orders-icon">📋</div>
                        <h3>Заказы не найдены</h3>
                        <p>Измените параметры фильтрации</p>
                    </div>
                `;
                return;
            }
            
            ordersList.innerHTML = `
                <div class="table-header">
                    <div class="table-header-item">№ ЗАКАЗА</div>
                    <div class="table-header-item">КЛИЕНТ</div>
                    <div class="table-header-item">ТЕЛЕФОН</div>
                    <div class="table-header-item">МАРШРУТ</div>
                    <div class="table-header-item">СТАТУС</div>
                    <div class="table-header-item">ВОДИТЕЛЬ</div>
                    <div class="table-header-item">ДЕЙСТВИЯ</div>
                </div>
            `;
            
            filteredOrders.forEach(order => {
                const statusClass = getStatusClass(order.status);
                const statusText = getStatusText(order.status);
                
                // Находим водителя
                let driverName = 'Не назначен';
                if (order.driverId) {
                    const driver = users.find(u => u.id === order.driverId);
                    if (driver) {
                        driverName = `${driver.firstName} ${driver.lastName}`;
                    }
                }
                
                const row = document.createElement('div');
                row.className = 'order-row';
                row.innerHTML = `
                    <div class="order-cell order-id" data-label="№ заказа">
                        <span class="order-id-text">#${order.id}</span>
                    </div>
                    <div class="order-cell" data-label="Клиент">
                        <span>${order.senderName}</span>
                    </div>
                    <div class="order-cell" data-label="Телефон">
                        <span>${order.senderPhone}</span>
                    </div>
                    <div class="order-cell" data-label="Маршрут">
                        <span class="address-line">${order.pickupAddress} → ${order.deliveryAddress}</span>
                    </div>
                    <div class="order-cell order-status-cell" data-label="Статус">
                        <div class="order-status ${statusClass}">
                            <span class="status-icon">●</span>
                            <span>${statusText}</span>
                        </div>
                    </div>
                    <div class="order-cell" data-label="Водитель">
                        <span>${driverName}</span>
                    </div>
                    <div class="order-cell order-actions-cell" data-label="Действия">
                        <div class="actions-container">
                            <div class="order-buttons">
                                <button class="view-btn" onclick="viewOrderDetails(${order.id})">Подробнее</button>
                                ${!order.driverId && order.status === 'confirmed' ? 
                                    `<button class="track-btn" onclick="openAssignDriverModal(${order.id})">Назначить</button>` : ''
                                }
                            </div>
                        </div>
                    </div>
                `;
                ordersList.appendChild(row);
            });
        }
        
        // Функция фильтрации заказов (админ)
        function filterAdminOrders() {
            loadAdminOrders();
        }
        
        // Функция сброса фильтров (админ)
        function resetAdminFilters() {
            document.getElementById('admin-status-filter').value = 'all';
            document.getElementById('admin-driver-filter').value = 'all';
            loadAdminOrders();
        }
        
        // Функция для загрузки заказов без водителя
        function loadUnassignedOrders() {
            const unassignedOrders = orders.filter(order => !order.driverId && order.status === 'confirmed');
            
            const content = document.getElementById('assign-driver-content');
            content.innerHTML = '';
            
            if (unassignedOrders.length === 0) {
                content.innerHTML = `
                    <div class="no-orders-container">
                        <div class="no-orders-icon">✅</div>
                        <h3>Нет заказов для назначения</h3>
                        <p>Все заказы уже назначены водителям</p>
                    </div>
                `;
                return;
            }
            
            content.innerHTML = `
                <div class="orders-table-container">
                    <div class="table-header">
                        <div class="table-header-item">№ ЗАКАЗА</div>
                        <div class="table-header-item">КЛИЕНТ</div>
                        <div class="table-header-item">МАРШРУТ</div>
                        <div class="table-header-item">ГРУЗ</div>
                        <div class="table-header-item">ДЕЙСТВИЯ</div>
                    </div>
                </div>
            `;
            
            const ordersList = content.querySelector('.orders-table-container');
            
            unassignedOrders.forEach(order => {
                const row = document.createElement('div');
                row.className = 'order-row';
                row.innerHTML = `
                    <div class="order-cell order-id" data-label="№ заказа">
                        <span class="order-id-text">#${order.id}</span>
                    </div>
                    <div class="order-cell" data-label="Клиент">
                        <span>${order.senderName}<br><small>${order.senderPhone}</small></span>
                    </div>
                    <div class="order-cell" data-label="Маршрут">
                        <span class="address-line">${order.pickupAddress} → ${order.deliveryAddress}</span>
                    </div>
                    <div class="order-cell" data-label="Груз">
                        <span class="cargo-text">${order.cargoDescription}</span>
                    </div>
                    <div class="order-cell order-actions-cell" data-label="Действия">
                        <div class="actions-container">
                            <div class="order-buttons">
                                <button class="view-btn" onclick="viewOrderDetails(${order.id})">Подробнее</button>
                                <button class="track-btn" onclick="openAssignDriverModal(${order.id})">Назначить водителя</button>
                            </div>
                        </div>
                    </div>
                `;
                ordersList.appendChild(row);
            });
        }
        
        // Функция для просмотра деталей заказа
        function viewOrderDetails(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;
            
            // Находим водителя
            let driverInfo = 'Не назначен';
            if (order.driverId) {
                const driver = users.find(u => u.id === order.driverId);
                if (driver) {
                    driverInfo = `${driver.firstName} ${driver.lastName}<br>${driver.phone}`;
                }
            }
            
            const statusText = getStatusText(order.status);
            const categoryName = getCategoryName(order.productCategory);
            const orderDate = new Date(order.createdAt).toLocaleDateString('ru-RU');
            const shippingDate = new Date(order.shippingDate).toLocaleDateString('ru-RU');
            
            document.getElementById('order-details-content').innerHTML = `
                <div class="order-form-row">
                    <div class="order-form-group">
                        <label>Номер заказа</label>
                        <input type="text" class="profile-field-readonly" value="#${order.id}" readonly>
                    </div>
                    <div class="order-form-group">
                        <label>Статус</label>
                        <input type="text" class="profile-field-readonly" value="${statusText}" readonly>
                    </div>
                </div>
                
                <h3>Информация о клиенте</h3>
                <div class="order-divider"></div>
                
                <div class="order-form-row">
                    <div class="order-form-group">
                        <label>Имя клиента</label>
                        <input type="text" class="profile-field-readonly" value="${order.senderName}" readonly>
                    </div>
                    <div class="order-form-group">
                        <label>Телефон</label>
                        <input type="text" class="profile-field-readonly" value="${order.senderPhone}" readonly>
                    </div>
                </div>
                
                <div class="order-form-row">
                    <div class="order-form-group">
                        <label>Email</label>
                        <input type="text" class="profile-field-readonly" value="${order.senderEmail || 'Не указан'}" readonly>
                    </div>
                    <div class="order-form-group">
                        <label>Дата заказа</label>
                        <input type="text" class="profile-field-readonly" value="${orderDate}" readonly>
                    </div>
                </div>
                
                <h3>Информация о грузе</h3>
                <div class="order-divider"></div>
                
                <div class="order-form-row">
                    <div class="order-form-group">
                        <label>Описание</label>
                        <textarea class="profile-field-readonly" rows="3" readonly>${order.cargoDescription}</textarea>
                    </div>
                </div>
                
                <div class="order-form-row">
                    <div class="order-form-group">
                        <label>Категория</label>
                        <input type="text" class="profile-field-readonly" value="${categoryName}" readonly>
                    </div>
                    <div class="order-form-group">
                        <label>Тип груза</label>
                        <input type="text" class="profile-field-readonly" value="${order.cargoType}" readonly>
                    </div>
                </div>
                
                <div class="order-form-row">
                    <div class="order-form-group">
                        <label>Вес</label>
                        <input type="text" class="profile-field-readonly" value="${order.cargoWeight} кг" readonly>
                    </div>
                    <div class="order-form-group">
                        <label>Объем</label>
                        <input type="text" class="profile-field-readonly" value="${order.cargoVolume} м³" readonly>
                    </div>
                </div>
                
                <h3>Маршрут</h3>
                <div class="order-divider"></div>
                
                <div class="order-form-row">
                    <div class="order-form-group">
                        <label>Откуда</label>
                        <input type="text" class="profile-field-readonly" value="${order.pickupAddress}" readonly>
                    </div>
                    <div class="order-form-group">
                        <label>Куда</label>
                        <input type="text" class="profile-field-readonly" value="${order.deliveryAddress}" readonly>
                    </div>
                </div>
                
                <div class="order-form-row">
                    <div class="order-form-group">
                        <label>Расстояние</label>
                        <input type="text" class="profile-field-readonly" value="${order.distance} км" readonly>
                    </div>
                    <div class="order-form-group">
                        <label>Дата отправки</label>
                        <input type="text" class="profile-field-readonly" value="${shippingDate}" readonly>
                    </div>
                </div>
                
                <h3>Финансы</h3>
                <div class="order-divider"></div>
                
                <div class="order-form-row">
                    <div class="order-form-group">
                        <label>Стоимость</label>
                        <input type="text" class="profile-field-readonly" value="${order.price} ₽" readonly>
                    </div>
                    <div class="order-form-group">
                        <label>Страховка</label>
                        <input type="text" class="profile-field-readonly" value="${order.insurance ? 'Да' : 'Нет'}" readonly>
                    </div>
                </div>
                
                <h3>Водитель</h3>
                <div class="order-divider"></div>
                
                <div class="order-form-group">
                    <label>Назначенный водитель</label>
                    <div style="padding: 15px; background: #f8f9fa; border-radius: 6px;">
                        ${driverInfo}
                    </div>
                </div>
            `;
            
            document.getElementById('viewOrderModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        // Функция закрытия модального окна просмотра заказа
        function closeViewOrderModal() {
            document.getElementById('viewOrderModal').classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        
        // Функция открытия модального окна назначения водителя
        function openAssignDriverModal(orderId) {
            orderToAssign = orderId;
            
            // Загружаем список водителей
            const drivers = users.filter(user => user.role === 'driver' && user.driverData);
            const select = document.getElementById('select-driver');
            select.innerHTML = '<option value="">Выберите водителя...</option>';
            
            drivers.forEach(driver => {
                const option = document.createElement('option');
                option.value = driver.id;
                option.textContent = `${driver.firstName} ${driver.lastName} (Рейтинг: ${driver.driverData.rating})`;
                select.appendChild(option);
            });
            
            document.getElementById('assignDriverModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        // Функция закрытия модального окна назначения водителя
        function closeAssignDriverModal() {
            document.getElementById('assignDriverModal').classList.remove('active');
            document.body.style.overflow = 'auto';
            orderToAssign = null;
        }
        
        // Функция назначения водителя на заказ
        function assignDriverToOrder() {
            const driverId = parseInt(document.getElementById('select-driver').value);
            if (!driverId) {
                showNotification('Выберите водителя', 'warning');
                return;
            }
            
            const orderIndex = orders.findIndex(o => o.id === orderToAssign);
            if (orderIndex === -1) return;
            
            // Назначаем водителя
            orders[orderIndex].driverId = driverId;
            orders[orderIndex].status = 'confirmed'; // Подтверждаем заказ
            orders[orderIndex].assignedAt = new Date().toISOString();
            
            localStorage.setItem('transportco_orders', JSON.stringify(orders));
            
            // Отправляем уведомление водителю
            const driver = users.find(u => u.id === driverId);
            if (driver) {
                showNotification(`Водитель ${driver.firstName} ${driver.lastName} назначен на заказ #${orderToAssign}`, 'success');
            }
            
            closeAssignDriverModal();
            
            // Обновляем все списки
            loadAdminOrders();
            loadUnassignedOrders();
            updateAdminStats();
            
            // Если текущий пользователь - водитель, обновляем его список
            if (currentUser && currentUser.id === driverId) {
                loadAvailableOrders();
            }
        }
        
        // Функции для работы с модальными окнами авторизации и регистрации
        function openLoginModal() {
            document.getElementById('loginModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function closeLoginModal() {
            document.getElementById('loginModal').classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        
        function openRegisterModal() {
            document.getElementById('registerModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function closeRegisterModal() {
            document.getElementById('registerModal').classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        
        function switchToRegister() {
            closeLoginModal();
            openRegisterModal();
        }
        
        function switchToLogin() {
            closeRegisterModal();
            openLoginModal();
        }
        
        // Функции для модальных окон регистрации с SMS
        function openConfirmRegisterCodeModal() {
            document.getElementById('confirmRegisterCodeModal').classList.add('active');
            document.body.style.overflow = 'hidden';
            startRegisterTimer();
        }
        
        function closeConfirmRegisterCodeModal() {
            document.getElementById('confirmRegisterCodeModal').classList.remove('active');
            document.body.style.overflow = 'auto';
            resetRegisterTimer();
        }
        
        function backToRegister() {
            closeConfirmRegisterCodeModal();
            openRegisterModal();
        }
        
        // Функция для перемещения между полями ввода кода при регистрации
        function moveToNextRegister(currentIndex, event) {
            const input = event.target;
            const value = input.value;
            
            if (value.length === 1 && currentIndex < 4) {
                document.getElementById(`reg-sms-code-${currentIndex + 1}`).focus();
            }
            
            if (event.inputType === 'deleteContentBackward' && currentIndex > 1 && value.length === 0) {
                document.getElementById(`reg-sms-code-${currentIndex - 1}`).focus();
            }
        }
        
        // Таймер для повторной отправки кода при регистрации
        let registerTimerInterval;
        let registerTimerSeconds = 59;
        
        function startRegisterTimer() {
            clearInterval(registerTimerInterval);
            registerTimerSeconds = 59;
            
            const resendCodeElement = document.getElementById('reg-resend-code');
            resendCodeElement.classList.add('disabled');
            
            registerTimerInterval = setInterval(() => {
                const timerElement = document.getElementById('reg-sms-timer');
                timerElement.textContent = `Пожалуйста подождите... ${registerTimerSeconds} сек`;
                
                if (registerTimerSeconds <= 0) {
                    clearInterval(registerTimerInterval);
                    timerElement.textContent = 'Код не пришел?';
                    resendCodeElement.classList.remove('disabled');
                }
                
                registerTimerSeconds--;
            }, 1000);
        }
        
        function resetRegisterTimer() {
            clearInterval(registerTimerInterval);
            document.getElementById('reg-sms-timer').textContent = 'Пожалуйста подождите... 59 сек';
            document.getElementById('reg-resend-code').classList.add('disabled');
        }
        
        // Функция для повторной отправки кода при регистрации
        function resendRegisterCode() {
            const resendCodeElement = document.getElementById('reg-resend-code');
            
            if (resendCodeElement.classList.contains('disabled')) {
                return;
            }
            
            showNotification('Код отправлен повторно!', 'success');
            startRegisterTimer();
        }
        
        // Функция для проверки введенного кода при регистрации
        function verifyRegisterCode() {
            const code1 = document.getElementById('reg-sms-code-1').value;
            const code2 = document.getElementById('reg-sms-code-2').value;
            const code3 = document.getElementById('reg-sms-code-3').value;
            const code4 = document.getElementById('reg-sms-code-4').value;
            
            const fullCode = code1 + code2 + code3 + code4;
            
            if (fullCode.length !== 4) {
                showNotification('Пожалуйста, введите полный код из 4 цифр', 'warning');
                return;
            }
            
            // Проверяем код (для демо используем "1234")
            if (fullCode === "1234") {
                // Регистрируем пользователя
                if (tempRegistrationData) {
                    const newUser = {
                        id: users.length + 1,
                        email: tempRegistrationData.email,
                        phone: tempRegistrationData.phone,
                        password: tempRegistrationData.password,
                        firstName: tempRegistrationData.firstName,
                        lastName: tempRegistrationData.lastName,
                        verified: true,
                        role: 'client' // По умолчанию клиент
                    };
                    
                    users.push(newUser);
                    localStorage.setItem('transportco_users', JSON.stringify(users));
                    
                    // Авторизуем пользователя
                    currentUser = newUser;
                    localStorage.setItem('transportco_currentUser', JSON.stringify(currentUser));
                    
                    showNotification('Регистрация подтверждена! Вы успешно зарегистрировались.', 'success');
                    closeConfirmRegisterCodeModal();
                    loginUser();
                    
                    // Переход на запомненную страницу или профиль
                    if (pendingPageAfterLogin) {
                        showPage(pendingPageAfterLogin);
                        pendingPageAfterLogin = null;
                    } else {
                        showPage('profile');
                    }
                } else {
                    showNotification('Ошибка регистрации: данные не найдены', 'error');
                }
            } else {
                showNotification('Неверный код подтверждения. Попробуйте еще раз.', 'error');
            }
        }
        
        // Функции для работы с модальными окнами восстановления пароля
        function openForgotPasswordModal() {
            closeLoginModal();
            document.getElementById('forgotPasswordModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function closeForgotPasswordModal() {
            document.getElementById('forgotPasswordModal').classList.remove('active');
            document.body.style.overflow = 'auto';
            openLoginModal();
        }
        
        function openConfirmCodeModal() {
            document.getElementById('confirmCodeModal').classList.add('active');
            document.body.style.overflow = 'hidden';
            startTimer();
        }
        
        function closeConfirmCodeModal() {
            document.getElementById('confirmCodeModal').classList.remove('active');
            document.body.style.overflow = 'auto';
            resetTimer();
        }
        
        function backToForgotPassword() {
            closeConfirmCodeModal();
            openForgotPasswordModal();
        }
        
        // Функция для отправки кода восстановления
        function sendRecoveryCode() {
            const contact = document.getElementById('recovery-contact').value;
            
            if (!contact) {
                showNotification('Заполните поле с телефоном или email', 'warning');
                return;
            }
            
            // Проверяем, существует ли пользователь
            const user = users.find(u => u.email === contact || u.phone === contact);
            if (!user) {
                showNotification('Пользователь с указанными данными не найден', 'error');
                return;
            }
            
            showNotification('Код восстановления отправлен!', 'success');
            closeForgotPasswordModal();
            openConfirmCodeModal();
        }
        
        // Функция для перемещения между полями ввода кода
        function moveToNext(currentIndex, event) {
            const input = event.target;
            const value = input.value;
            
            if (value.length === 1 && currentIndex < 4) {
                document.getElementById(`sms-code-${currentIndex + 1}`).focus();
            }
            
            if (event.inputType === 'deleteContentBackward' && currentIndex > 1 && value.length === 0) {
                document.getElementById(`sms-code-${currentIndex - 1}`).focus();
            }
        }
        
        // Таймер для повторной отправки кода
        let timerInterval;
        let timerSeconds = 59;
        
        function startTimer() {
            clearInterval(timerInterval);
            timerSeconds = 59;
            
            const resendCodeElement = document.getElementById('resend-code');
            resendCodeElement.classList.add('disabled');
            
            timerInterval = setInterval(() => {
                const timerElement = document.getElementById('sms-timer');
                timerElement.textContent = `Пожалуйста подождите... ${timerSeconds} сек`;
                
                if (timerSeconds <= 0) {
                    clearInterval(timerInterval);
                    timerElement.textContent = 'Код не пришел?';
                    resendCodeElement.classList.remove('disabled');
                }
                
                timerSeconds--;
            }, 1000);
        }
        
        function resetTimer() {
            clearInterval(timerInterval);
            document.getElementById('sms-timer').textContent = 'Пожалуйста подождите... 59 сек';
            document.getElementById('resend-code').classList.add('disabled');
        }
        
        // Функция для повторной отправки кода
        function resendCode() {
            const resendCodeElement = document.getElementById('resend-code');
            
            if (resendCodeElement.classList.contains('disabled')) {
                return;
            }
            
            showNotification('Код отправлен повторно!', 'success');
            startTimer();
        }
        
        // Функция для проверки введенного кода
        function verifyCode() {
            const code1 = document.getElementById('sms-code-1').value;
            const code2 = document.getElementById('sms-code-2').value;
            const code3 = document.getElementById('sms-code-3').value;
            const code4 = document.getElementById('sms-code-4').value;
            
            const fullCode = code1 + code2 + code3 + code4;
            
            if (fullCode.length !== 4) {
                showNotification('Пожалуйста, введите полный код из 4 цифр', 'warning');
                return;
            }
            
            const contact = document.getElementById('recovery-contact').value;
            
            // Для демо используем "1234" как правильный код
            if (fullCode === "1234") {
                // Запрашиваем новый пароль
                const newPassword = prompt('Введите новый пароль:');
                
                if (!newPassword || newPassword.length < 6) {
                    showNotification('Пароль должен содержать не менее 6 символов', 'error');
                    return;
                }
                
                // Находим пользователя и обновляем пароль
                const userIndex = users.findIndex(u => u.email === contact || u.phone === contact);
                if (userIndex !== -1) {
                    users[userIndex].password = newPassword;
                    localStorage.setItem('transportco_users', JSON.stringify(users));
                    
                    // Если текущий пользователь - обновляем его данные
                    if (currentUser && (currentUser.email === contact || currentUser.phone === contact)) {
                        currentUser.password = newPassword;
                        localStorage.setItem('transportco_currentUser', JSON.stringify(currentUser));
                    }
                    
                    showNotification('Пароль успешно изменен! Теперь вы можете войти с новым паролем.', 'success');
                    closeConfirmCodeModal();
                    openLoginModal();
                } else {
                    showNotification('Пользователь не найден', 'error');
                }
            } else {
                showNotification('Неверный код подтверждения', 'error');
            }
        }
        
        // Функции для отображения ошибок в формах авторизации/регистрации
        function showError(inputId, message) {
            const input = document.getElementById(inputId);
            const errorElement = document.getElementById(inputId + '-error');
            
            if (input && errorElement) {
                input.classList.add('error');
                errorElement.textContent = message;
                errorElement.classList.add('show');
                errorElement.style.display = 'block';
            }
        }
        
        function clearError(inputId) {
            const input = document.getElementById(inputId);
            const errorElement = document.getElementById(inputId + '-error');
            
            if (input && errorElement) {
                input.classList.remove('error');
                errorElement.textContent = '';
                errorElement.classList.remove('show');
                errorElement.style.display = 'none';
            }
        }
        
        function clearAllErrors() {
            const errorMessages = document.querySelectorAll('.error-message');
            const inputs = document.querySelectorAll('.auth-input');
            
            errorMessages.forEach(error => {
                error.textContent = '';
                error.classList.remove('show');
                error.style.display = 'none';
            });
            
            inputs.forEach(input => {
                input.classList.remove('error');
            });
        }
        
        // Функции для отображения ошибок в форме заказа
        function showOrderError(inputId, message) {
            const input = document.getElementById(inputId);
            const errorElement = document.getElementById(inputId + '-error');
            
            if (input && errorElement) {
                input.classList.add('error');
                errorElement.textContent = message;
                errorElement.classList.add('show');
                errorElement.style.display = 'block';
            }
        }
        
        function clearOrderError(inputId) {
            const input = document.getElementById(inputId);
            const errorElement = document.getElementById(inputId + '-error');
            
            if (input && errorElement) {
                input.classList.remove('error');
                errorElement.textContent = '';
                errorElement.classList.remove('show');
                errorElement.style.display = 'none';
            }
        }
        
        function clearAllOrderErrors() {
            const errorMessages = document.querySelectorAll('.order-error-message');
            const inputs = document.querySelectorAll('#orderForm input, #orderForm textarea, #orderForm select');
            
            errorMessages.forEach(error => {
                error.textContent = '';
                error.classList.remove('show');
                error.style.display = 'none';
            });
            
            inputs.forEach(input => {
                input.classList.remove('error');
            });
        }
        
        // Обработчики форм
        function handleLogin() {
            const login = document.getElementById('auth-login').value;
            const password = document.getElementById('auth-password').value;
            
            clearAllErrors();
            
            let hasError = false;
            
            if (!login) {
                showError('auth-login', 'Заполните это поле');
                hasError = true;
            }
            
            if (!password) {
                showError('auth-password', 'Заполните это поле');
                hasError = true;
            }
            
            if (hasError) {
                return;
            }
            
            // Поиск пользователя
            const user = users.find(u => 
                (u.email === login || u.phone === login) && u.password === password
            );
            
            if (user) {
                if (!user.verified) {
                    showError('auth-login', 'Аккаунт не подтвержден. Проверьте вашу почту или телефон.');
                    showNotification('Аккаунт не подтвержден. Проверьте вашу почту или телефон.', 'warning');
                    return;
                }
                
                currentUser = user;
                localStorage.setItem('transportco_currentUser', JSON.stringify(currentUser));
                showNotification('Вход выполнен успешно!', 'success');
                closeLoginModal();
                loginUser();
                
                // Переход на запомненную страницу или профиль
                if (pendingPageAfterLogin) {
                    showPage(pendingPageAfterLogin);
                    pendingPageAfterLogin = null;
                } else {
                    showPage('profile');
                }
            } else {
                // Проверяем, что именно неверно
                const userExists = users.some(u => u.email === login || u.phone === login);
                if (!userExists) {
                    showError('auth-login', 'Неверный телефон или email');
                    showNotification('Неверный телефон или email', 'error');
                } else {
                    showError('auth-password', 'Неверный пароль');
                    showNotification('Неверный пароль', 'error');
                }
            }
        }
        
        function handleRegister() {
            const firstName = document.getElementById('reg-firstName').value;
            const lastName = document.getElementById('reg-lastName').value;
            const email = document.getElementById('reg-email').value;
            const phone = document.getElementById('reg-phone').value;
            const password = document.getElementById('reg-password').value;
            const confirmPassword = document.getElementById('reg-confirmPassword').value;
            const agreeTerms = document.getElementById('reg-agreeTerms').checked;
            
            clearAllErrors();
            
            let hasError = false;
            
            if (!firstName) {
                showError('reg-firstName', 'Заполните это поле');
                hasError = true;
            }
            
            if (!lastName) {
                showError('reg-lastName', 'Заполните это поле');
                hasError = true;
            }
            
            if (!email) {
                showError('reg-email', 'Заполните это поле');
                hasError = true;
            } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                showError('reg-email', 'Введите корректный email');
                hasError = true;
            } else if (users.some(u => u.email === email)) {
                showError('reg-email', 'Пользователь с таким email уже существует');
                hasError = true;
            }
            
            if (!phone) {
                showError('reg-phone', 'Заполните это поле');
                hasError = true;
            } else if (users.some(u => u.phone === phone)) {
                showError('reg-phone', 'Пользователь с таким телефоном уже существует');
                hasError = true;
            }
            
            if (!password) {
                showError('reg-password', 'Заполните это поле');
                hasError = true;
            } else if (password.length < 6) {
                showError('reg-password', 'Пароль должен содержать не менее 6 символов');
                hasError = true;
            }
            
            if (!confirmPassword) {
                showError('reg-confirmPassword', 'Заполните это поле');
                hasError = true;
            } else if (password !== confirmPassword) {
                showError('reg-confirmPassword', 'Пароли не совпадают');
                hasError = true;
            }
            
            if (!agreeTerms) {
                showNotification('Необходимо согласиться с условиями использования', 'warning');
                return;
            }
            
            if (hasError) {
                return;
            }
            
            // Сохраняем данные регистрации
            tempRegistrationData = {
                firstName,
                lastName,
                email,
                phone,
                password
            };
            
            showNotification('Регистрация начата! Проверьте SMS для подтверждения.', 'info');
            
            // Закрываем окно регистрации и открываем окно подтверждения SMS
            closeRegisterModal();
            openConfirmRegisterCodeModal();
        }
        
        // Функция для извлечения города из адреса
        function extractCityFromAddress(address) {
            if (!address) return '';
            
            // Простой способ извлечь город (первое слово до запятой)
            const parts = address.split(',');
            if (parts.length > 0) {
                return parts[0].trim();
            }
            
            // Если нет запятых, берем первое слово
            const words = address.trim().split(' ');
            return words[0] || '';
        }

        // Функция расчета расстояния между адресами
        function calculateDistanceBetweenAddresses(address1, address2) {
            const city1 = extractCityFromAddress(address1);
            const city2 = extractCityFromAddress(address2);
            
            return calculateDistance(city1, city2);
        }

        // Функция расчета цены с учетом расстояния и страховки 1%
        function calculateOrderPrice(orderData, distance) {
            // Базовые тарифы
            const BASE_PRICE = 1000; // Базовая стоимость заказа
            const PRICE_PER_KM = 20; // Стоимость за километр
            const PRICE_PER_KG = 80; // Стоимость за килограмм
            const PRICE_PER_M3 = 400; // Стоимость за кубический метр
            
            // Коэффициенты для типов груза
            const cargoTypeMultiplier = {
                'general': 1.0,
                'fragile': 1.3,
                'dangerous': 1.5,
                'perishable': 1.4
            };
            
            // Рассчитываем компоненты стоимости
            const distanceCost = distance * PRICE_PER_KM;
            const weightCost = orderData.cargoWeight * PRICE_PER_KG;
            const volumeCost = orderData.cargoVolume * PRICE_PER_M3;
            
            // Рассчитываем стоимость доставки
            let deliveryCost = BASE_PRICE + distanceCost + weightCost + volumeCost;
            
            // Применяем коэффициент типа груза
            const multiplier = cargoTypeMultiplier[orderData.cargoType] || 1.0;
            deliveryCost *= multiplier;
            
            // Дополнительные услуги
            let additionalCost = 0;
            if (orderData.packaging) {
                additionalCost += 2000; // Упаковка
            }
            
            // Страховка - 1% от стоимости доставки
            if (orderData.insurance) {
                const insuranceCost = deliveryCost * 0.01;
                additionalCost += insuranceCost;
            }
            
            // Итоговая стоимость
            const totalPrice = Math.round(deliveryCost + additionalCost);
            
            return totalPrice;
        }
        
        // Обновленная функция handleOrderSubmit
        function handleOrderSubmit(event) {
            event.preventDefault();
            
            clearAllOrderErrors();
            
            const senderName = document.getElementById('sender-name').value;
            const senderPhone = document.getElementById('sender-phone').value;
            const senderEmail = document.getElementById('sender-email').value;
            const cargoDescription = document.getElementById('cargo-description').value;
            const productCategory = document.getElementById('product-category').value;
            const cargoWeight = document.getElementById('cargo-weight').value;
            const cargoVolume = document.getElementById('cargo-volume').value;
            const cargoType = document.getElementById('cargo-type').value;
            const shippingDate = document.getElementById('shipping-date').value;
            const pickupAddress = document.getElementById('pickup-address').value;
            const deliveryAddress = document.getElementById('delivery-address').value;
            const insurance = document.getElementById('insurance').checked;
            const packaging = document.getElementById('packaging').checked;
            const tracking = document.getElementById('tracking').checked;
            const comments = document.getElementById('comments').value;
            
            let hasError = false;
            
            if (!senderName) {
                showOrderError('sender-name', 'Заполните это поле');
                hasError = true;
            }
            
            if (!senderPhone) {
                showOrderError('sender-phone', 'Заполните это поле');
                hasError = true;
            }
            
            if (!cargoDescription) {
                showOrderError('cargo-description', 'Заполните это поле');
                hasError = true;
            }
            
            if (!productCategory) {
                showOrderError('product-category', 'Выберите категорию товара');
                hasError = true;
            }
            
            if (!cargoWeight || parseFloat(cargoWeight) <= 0) {
                showOrderError('cargo-weight', 'Введите корректный вес');
                hasError = true;
            }
            
            if (!cargoVolume || parseFloat(cargoVolume) <= 0) {
                showOrderError('cargo-volume', 'Введите корректный объем');
                hasError = true;
            }
            
            if (!cargoType) {
                showOrderError('cargo-type', 'Выберите тип груза');
                hasError = true;
            }
            
            if (!shippingDate) {
                showOrderError('shipping-date', 'Выберите дату отправки');
                hasError = true;
            }
            
            if (!pickupAddress) {
                showOrderError('pickup-address', 'Заполните это поле');
                hasError = true;
            }
            
            if (!deliveryAddress) {
                showOrderError('delivery-address', 'Заполните это поле');
                hasError = true;
            }
            
            if (hasError) {
                showNotification('Пожалуйста, заполните все обязательные поля корректно', 'warning');
                return false;
            }
            
            // РАСЧЕТ РАССТОЯНИЯ
            const distance = calculateDistanceBetweenAddresses(pickupAddress, deliveryAddress);
            
            // Создаем объект с данными заказа для расчета цены
            const orderDataForPrice = {
                cargoWeight: parseFloat(cargoWeight),
                cargoVolume: parseFloat(cargoVolume),
                cargoType: cargoType,
                insurance: insurance,
                packaging: packaging
            };
            
            // Рассчитываем цену с учетом расстояния
            const calculatedPrice = calculateOrderPrice(orderDataForPrice, distance);
            
            const maxId = orders.length > 0 ? Math.max(...orders.map(order => order.id)) : 0;
            const orderRecord = {
                id: maxId + 1,
                userId: currentUser ? currentUser.id : null,
                senderName,
                senderPhone,
                senderEmail,
                cargoDescription,
                productCategory,
                cargoWeight: parseFloat(cargoWeight),
                cargoVolume: parseFloat(cargoVolume),
                cargoType,
                shippingDate,
                pickupAddress,
                deliveryAddress,
                distance: distance, // Сохраняем расстояние
                insurance,
                packaging,
                tracking,
                comments,
                status: 'new',
                price: calculatedPrice, // Используем новую рассчитанную цену
                createdAt: new Date().toISOString()
            };
            
            orders.push(orderRecord);
            localStorage.setItem('transportco_orders', JSON.stringify(orders));
            
            // Показываем уведомление с информацией о цене и расстоянии
            let notificationMessage = `Заказ успешно оформлен!`;
            notificationMessage += `<br>Расстояние: ${distance} км`;
            notificationMessage += `<br>Стоимость доставки: ${calculatedPrice} ₽`;
            
            if (insurance) {
                notificationMessage += '<br>Включена страховка: 1% от стоимости доставки';
            }
            
            notificationMessage += '<br>Наш менеджер свяжется с вами в течение 30 минут.';
            
            // Показываем расширенное уведомление
            const notification = showNotification(notificationMessage, 'success', 8000);
            
            // Добавляем HTML форматирование в уведомление
            const contentDiv = notification.querySelector('.notification-content');
            contentDiv.innerHTML = notificationMessage;
            
            // Сбрасываем форму
            document.getElementById('orderForm').reset();
            
            // Если пользователь авторизован, показываем профиль
            if (currentUser) {
                showPage('profile');
                showProfileTab('orders');
                updateProfileOrderStats();
            } else {
                showPage('main');
            }
            
            return false;
        }
        
        function handleContactSubmit(event) {
            event.preventDefault();
            
            const contactData = {
                name: document.getElementById('contact-name').value,
                email: document.getElementById('contact-email').value,
                phone: document.getElementById('contact-phone').value,
                message: document.getElementById('contact-message').value
            };
            
            showNotification('Сообщение успешно отправлено! Мы ответим вам в ближайшее время.', 'success');
            document.getElementById('contactForm').reset();
            
            return false;
        }
        
        // Функции для страницы "Мои заказы" в профиле
        function toggleOrdersVisibility(hasOrders) {
            const ordersTable = document.getElementById('profile-orders-table');
            const noOrdersMessage = document.getElementById('profile-no-orders-message');
            
            if (hasOrders) {
                if (ordersTable) ordersTable.style.display = 'block';
                if (noOrdersMessage) noOrdersMessage.style.display = 'none';
            } else {
                if (ordersTable) ordersTable.style.display = 'none';
                if (noOrdersMessage) noOrdersMessage.style.display = 'block';
            }
        }
        
        function viewOrder(orderId) {
            showNotification(`Просмотр заказа ${orderId}`, 'info');
        }
        
        function trackOrder(orderId) {
            showNotification(`Отслеживание заказа ${orderId}`, 'info');
        }
        
        // Закрытие модальных окон при клике вне их
        document.addEventListener('click', function(event) {
            const modals = ['loginModal', 'registerModal', 'forgotPasswordModal', 'confirmCodeModal', 'confirmRegisterCodeModal', 'viewOrderModal', 'assignDriverModal'];
            
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (event.target === modal) {
                    if (modalId === 'loginModal') closeLoginModal();
                    if (modalId === 'registerModal') closeRegisterModal();
                    if (modalId === 'forgotPasswordModal') closeForgotPasswordModal();
                    if (modalId === 'confirmCodeModal') closeConfirmCodeModal();
                    if (modalId === 'confirmRegisterCodeModal') closeConfirmRegisterCodeModal();
                    if (modalId === 'viewOrderModal') closeViewOrderModal();
                    if (modalId === 'assignDriverModal') closeAssignDriverModal();
                }
            });
        });
        
        // Закрытие модальных окон при нажатии Escape
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeLoginModal();
                closeRegisterModal();
                closeForgotPasswordModal();
                closeConfirmCodeModal();
                closeConfirmRegisterCodeModal();
                closeViewOrderModal();
                closeAssignDriverModal();
            }
        });
        
        // Инициализация
        document.addEventListener('DOMContentLoaded', function() {
            // Установить сегодняшнюю дату в поле даты отправки
            const today = new Date().toISOString().split('T')[0];
            const shippingDate = document.getElementById('shipping-date');
            if (shippingDate) {
                shippingDate.min = today;
            }
            
            // Проверяем авторизацию при загрузке
            if (currentUser) {
                loginUser();
            }
            
            // По умолчанию показываем сообщение об отсутствии заказов
            toggleOrdersVisibility(false);
            
            // Добавляем обработчики фильтров заказов
            const statusFilter = document.getElementById('profile-status-filter');
            const periodFilter = document.getElementById('profile-period-filter');
            const searchInput = document.getElementById('profile-search-input');
            
            if (statusFilter) {
                statusFilter.addEventListener('change', filterProfileOrders);
            }
            if (periodFilter) {
                periodFilter.addEventListener('change', filterProfileOrders);
            }
            if (searchInput) {
                searchInput.addEventListener('input', filterProfileOrders);
            }
            
            // Инициализируем данные админа
            if (currentUser && currentUser.role === 'admin') {
                updateAdminStats();
            }
        });
    </script>
</body>
</html>